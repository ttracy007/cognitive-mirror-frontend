{"ast":null,"code":"var _jsxFileName = \"/Users/mac/Projects/cognitive-mirror-frontend-dev/src/SummaryViewer.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport SummaryBlock from './SummaryBlock';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst SummaryViewer = ({\n  history,\n  onClose\n}) => {\n  _s();\n  const [summaries, setSummaries] = useState({\n    insight: null,\n    clinical: null\n  });\n  const [isLoading, setIsLoading] = useState(false);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const copyToClipboard = text => {\n    navigator.clipboard.writeText(text);\n  };\n  const generateAllSummaries = async () => {\n    setIsLoading(true);\n    setIsModalOpen(true);\n    try {\n      const types = ['insight', 'clinical'];\n      const recentHistory = history.slice(0, 10); // Only last 10\n\n      const fetchSummary = type => {\n        return fetch(`${process.env.REACT_APP_BACKEND_URL}/generate-summary`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            history: recentHistory,\n            summary_type: type\n          })\n        }).then(res => res.json());\n      };\n\n      // ✅ Await all fetches properly here\n      const results = await Promise.all(types.map(type => fetchSummary(type)));\n      setSummaries({\n        insight: results[0].summary,\n        clinical: results[1].summary\n      });\n    } catch (err) {\n      console.error(\"❌ Failed to generate summaries:\", err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Auto-trigger summaries on mount\n\n  useEffect(() => {\n    generateAllSummaries();\n  }, []);\n\n  // React.useEffect(() => {\n  //   generateAllSummaries();\n  // }, []);\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      maxHeight: '90vh',\n      overflowY: 'auto',\n      fontFamily: 'sans-serif',\n      paddingBottom: '6rem'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"\\uD83E\\uDDFE Handoff Summaries\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this), isLoading ? /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"\\uD83D\\uDD04 Generating summaries...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        style: {\n          fontSize: '1.3rem',\n          marginBottom: '0.25rem'\n        },\n        children: \"\\uD83E\\uDDE0 Insight Summary\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          fontSize: '0.9rem',\n          color: '#555',\n          marginTop: 0,\n          marginBottom: '1rem'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Empathic. Reflective. Grounded.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 61\n        }, this), \"A therapist-to-therapist narrative that distills emotional patterns, protective strategies, and therapeutic needs.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(SummaryBlock, {\n        label: \"Insight Summary\",\n        content: summaries.insight || 'Summary not available.',\n        onCopy: () => {\n          var _summaries$insight;\n          return copyToClipboard((_summaries$insight = summaries.insight) === null || _summaries$insight === void 0 ? void 0 : _summaries$insight.summary);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        style: {\n          fontSize: '1.3rem',\n          marginBottom: '0.25rem'\n        },\n        children: \"\\uD83E\\uDDE0 Clinical Summary\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          fontSize: '0.9rem',\n          color: '#555',\n          marginTop: 0,\n          marginBottom: '1rem'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Structured. DSM-Informed. Objective.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 66\n        }, this), \"A concise intake-style overview highlighting symptom patterns, cognitive tendencies, and behavioral dynamics.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(SummaryBlock, {\n        label: \"Clinical Summary\",\n        content: summaries.clinical || 'Summary not available.',\n        onCopy: () => {\n          var _summaries$clinical;\n          return copyToClipboard((_summaries$clinical = summaries.clinical) === null || _summaries$clinical === void 0 ? void 0 : _summaries$clinical.summary);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: onClose,\n      style: {\n        marginTop: '2rem',\n        padding: '0.75rem 1.5rem',\n        fontSize: '1rem',\n        backgroundColor: '#eee',\n        border: '1px solid #ccc',\n        cursor: 'pointer'\n      },\n      children: \"Close\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 62,\n    columnNumber: 5\n  }, this);\n};\n_s(SummaryViewer, \"7OM6ZoOcYGkmL/bqV9ak50F2rMc=\");\n_c = SummaryViewer;\nexport default SummaryViewer;\nvar _c;\n$RefreshReg$(_c, \"SummaryViewer\");","map":{"version":3,"names":["React","useState","useEffect","SummaryBlock","jsxDEV","_jsxDEV","Fragment","_Fragment","SummaryViewer","history","onClose","_s","summaries","setSummaries","insight","clinical","isLoading","setIsLoading","isModalOpen","setIsModalOpen","copyToClipboard","text","navigator","clipboard","writeText","generateAllSummaries","types","recentHistory","slice","fetchSummary","type","fetch","process","env","REACT_APP_BACKEND_URL","method","headers","body","JSON","stringify","summary_type","then","res","json","results","Promise","all","map","summary","err","console","error","style","maxHeight","overflowY","fontFamily","paddingBottom","children","fileName","_jsxFileName","lineNumber","columnNumber","fontSize","marginBottom","color","marginTop","label","content","onCopy","_summaries$insight","_summaries$clinical","onClick","padding","backgroundColor","border","cursor","_c","$RefreshReg$"],"sources":["/Users/mac/Projects/cognitive-mirror-frontend-dev/src/SummaryViewer.js"],"sourcesContent":["import React, { useState, useEffect } from 'react'; \nimport SummaryBlock from './SummaryBlock';\n\n\nconst SummaryViewer = ({ history, onClose }) => {\n  const [summaries, setSummaries] = useState({\n    insight: null,\n    clinical: null,\n  });\n\n  const [isLoading, setIsLoading] = useState(false);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n\n  const copyToClipboard = (text) => {\n    navigator.clipboard.writeText(text);\n  };\n\n  const generateAllSummaries = async () => {\n  setIsLoading(true);\n  setIsModalOpen(true);\n\n  try {\n    const types = ['insight', 'clinical'];\n    const recentHistory = history.slice(0, 10); // Only last 10\n\n    const fetchSummary = (type) => {\n      return fetch(`${process.env.REACT_APP_BACKEND_URL}/generate-summary`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          history: recentHistory,\n          summary_type: type,\n        }),\n      }).then(res => res.json());\n    };\n\n    // ✅ Await all fetches properly here\n    const results = await Promise.all(types.map(type => fetchSummary(type)));\n\n    setSummaries({\n      insight: results[0].summary,\n      clinical: results[1].summary,\n    });\n  } catch (err) {\n    console.error(\"❌ Failed to generate summaries:\", err);\n  } finally {\n    setIsLoading(false);\n  }\n};   \n       \n  // Auto-trigger summaries on mount\n \n  useEffect(() => {\n    generateAllSummaries();\n  }, []);\n  \n  // React.useEffect(() => {\n  //   generateAllSummaries();\n  // }, []);\n\n  return (\n    <div\n      style={{\n        maxHeight: '90vh',\n        overflowY: 'auto',\n        fontFamily: 'sans-serif',\n        paddingBottom: '6rem'\n      }}\n    >\n      <h2>🧾 Handoff Summaries</h2>\n\n      {isLoading ? (\n        <p>🔄 Generating summaries...</p>\n      ) : (\n        <>\n          {/* Insight Summary */}\n          <h3 style={{ fontSize: '1.3rem', marginBottom: '0.25rem' }}>🧠 Insight Summary</h3>\n          <p style={{ fontSize: '0.9rem', color: '#555', marginTop: 0, marginBottom: '1rem' }}>\n            <strong>Empathic. Reflective. Grounded.</strong><br />\n            A therapist-to-therapist narrative that distills emotional patterns, protective strategies, and therapeutic needs.\n          </p>\n          <SummaryBlock\n            label=\"Insight Summary\"\n            content={summaries.insight|| 'Summary not available.'}\n            onCopy={() => copyToClipboard(summaries.insight?.summary)}\n          />\n\n          {/* Clinical Summary */}\n          <h3 style={{ fontSize: '1.3rem', marginBottom: '0.25rem' }}>🧠 Clinical Summary</h3>\n          <p style={{ fontSize: '0.9rem', color: '#555', marginTop: 0, marginBottom: '1rem' }}>\n            <strong>Structured. DSM-Informed. Objective.</strong><br />\n            A concise intake-style overview highlighting symptom patterns, cognitive tendencies, and behavioral dynamics.\n          </p>\n          <SummaryBlock\n            label=\"Clinical Summary\"\n            content={summaries.clinical || 'Summary not available.'}\n            onCopy={() => copyToClipboard(summaries.clinical?.summary)}\n          />\n\n          \n        </>\n      )}\n\n      <button\n        onClick={onClose}\n        style={{\n          marginTop: '2rem',\n          padding: '0.75rem 1.5rem',\n          fontSize: '1rem',\n          backgroundColor: '#eee',\n          border: '1px solid #ccc',\n          cursor: 'pointer',\n        }}\n      >\n        Close\n      </button>\n    </div>\n  );\n};\n\nexport default SummaryViewer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}