{"ast":null,"code":"var _jsxFileName = \"/Users/mac/Projects/cognitive-mirror-frontend-dev/src/App.js\",\n  _s2 = $RefreshSig$();\n// üîº Imports and Setup      \nimport React, { useEffect, useState } from 'react';\nimport SummaryViewer from './SummaryViewer';\nimport { supabase, UsernameStore, getBootSession, subscribeAuth } from './supabaseClient';\nimport './App.css';\n// import DemoSofia from './pages/DemoSofia';\nimport LandingPage from './LandingPage';\nimport LoginPage from './LoginPage';\nimport JournalTimeline from './components/JournalTimeline';\nimport MoodModal from './components/MoodModal';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst App = () => {\n  _s2();\n  var _session$user, _session$user2, _session$user3, _session$user4;\n  // --- Tone descriptions map ---\n  const toneDescriptions = {\n    therapist: \"ü©∫ Clara ‚Äì A warm, grounded therapist who sees the pattern beneath the panic.\",\n    marcus: \"üßò Marcus ‚Äì Speaks like the Stoic philosopher himself. Will quote Meditations.\",\n    frank: \"üí™üç∑ Tony ‚Äì A frank, no-bullshit friend who tells you what you need to hear.\",\n    movies: \"üé¨ Movies ‚Äì A movie buff who only speaks through movie metaphors.\",\n    verena: \"üå∏ Verena ‚Äì A clarity-driven life coach unphased by self-pity.\"\n  };\n\n  // Default to Clara\n  const [forcedTone, setForcedTone] = useState(\"therapist\");\n  // Keep a visible description bound to the current selection\n  const [toneDescription, setToneDescription] = useState(toneDescriptions[\"therapist\"]);\n  const handleToneChange = e => {\n    const val = e.target.value;\n    setForcedTone(val);\n    setToneDescription(toneDescriptions[val] || \"\");\n  };\n  const toneName = t => ({\n    therapist: 'Clara',\n    marcus: 'Marcus',\n    frank: 'Tony',\n    movies: 'Movies',\n    verena: 'Verena'\n  })[t] || 'Mirror';\n\n  // üîΩ Existing states (no change to their order beyond moving forcedTone here)\n  const [showLogin, setShowLogin] = useState(false);\n  const [session, setSession] = useState(null);\n  const [entry, setEntry] = useState('');\n  const [history, setHistory] = useState([]);\n  const [tooltip, setTooltip] = useState(\"ü©∫ Clara ‚Äì A warm, grounded therapist who sees the pattern beneath the panic.\");\n  const [latestEntryId, setLatestEntryId] = useState(null);\n  const [showSummary, setShowSummary] = useState(false);\n  const [loadingSummary, setLoadingSummary] = useState(false);\n  const [summary, setSummary] = useState('');\n  const [parsedTags, setParsedTags] = useState([]);\n  const [severityLevel, setSeverityLevel] = useState('');\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [recognition, setRecognition] = useState(null);\n  const [inputExpanded, setInputExpanded] = useState(false);\n  const [isListening, setIsListening] = useState(false);\n  const prompts = [\"What‚Äôs shaking sugar?\"];\n  const [showGroupedView, setShowGroupedView] = useState(false);\n  const [placeholderPrompt, setPlaceholderPrompt] = useState(() => prompts[Math.floor(Math.random() * prompts.length)]);\n  const [refreshTrigger, setRefreshTrigger] = useState(0);\n  let transcriptBuffer = '';\n  const [tooltipVisible, setTooltipVisible] = useState(null); // 'pattern' | 'therapist' | 'mood' | null\n  const [styleVariant, setStyleVariant] = useState(\"D\");\n  const [showWelcome, setShowWelcome] = useState(false);\n  const [welcomeStep, setWelcomeStep] = useState(1);\n  const [username, setUsername] = useState('');\n  const [showMoodTracker, setShowMoodTracker] = useState(false);\n  const handleCloseMoodTracker = () => setShowMoodTracker(false);\n  const handleOpenMoodTracker = () => setShowMoodTracker(true);\n\n  // üîΩ Function 1: Load Saved Username (rehydrate)\n  useEffect(() => {\n    const saved = UsernameStore.get();\n    if (saved) setUsername(saved);\n  }, []);\n\n  // Log environment on startup\n  useEffect(() => {\n    console.log(`üöÄ Running in ${process.env.REACT_APP_ENV || 'unknown'} mode`);\n    console.log(`üõ∞Ô∏è Backend: ${process.env.REACT_APP_BACKEND_URL || 'unset'}`);\n    console.log(`üóÑÔ∏è Supabase: ${process.env.REACT_APP_SUPABASE_URL || 'unset'}`);\n  }, []);\n\n  // üîΩ Function 3: Show Summary Trigger\n  useEffect(() => {\n    const hasTriggeredSummary = localStorage.getItem('hasTriggeredSummary');\n    if (!hasTriggeredSummary && history.length >= 5) {\n      setShowSummary(true);\n      localStorage.setItem('hasTriggeredSummary', 'true');\n    }\n  }, [history]);\n\n  // üîΩ Function 3a: Build Current Commit Tag \n  useEffect(() => {\n    fetch('/build-version.txt').then(res => res.text()).then(text => {\n      console.log(\"üõ†Ô∏è App.js version:\", text);\n      // console.log(`üß± Frontend build version: ${text}`);\n    });\n  }, []);\n\n  // üîΩ Function 4: Auth Setup (boot + subscribe once)\n  useEffect(() => {\n    let stop = () => {};\n    (async () => {\n      setSession(await getBootSession());\n      stop = subscribeAuth(setSession);\n    })();\n    return () => stop();\n  }, []);\n\n  // üîΩ Function 5: Submit New Journal Entry (username/session‚Äìsafe)\n  const handleSubmit = async () => {\n    var _s;\n    console.warn(\"üß™ handleSubmit called!\");\n\n    // Always read a stable username\n    const u = (username || UsernameStore.get() || '').trim();\n\n    // Make sure we have a session\n    let s = session;\n    if (!s) {\n      s = await getBootSession();\n      if (s) setSession(s);\n    }\n\n    // Guard rails: must have session + entry + username\n    if (!((_s = s) !== null && _s !== void 0 && _s.user) || !entry.trim() || !u) return;\n    setProcessingMessage(`‚è≥ ${toneName(forcedTone)} is thinking...`);\n    setIsProcessing(true);\n    const debug_marker = Math.random().toString(36).substring(2, 8);\n    const userId = s.user.id;\n    try {\n      const res = await fetch(`${process.env.REACT_APP_BACKEND_URL}/journal-entry`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          entry_text: entry,\n          tone_mode: forcedTone,\n          username: u,\n          // <-- use stable value\n          user_id: userId,\n          debug_marker\n        })\n      });\n      const data = await res.json();\n      const responseText = data.response || 'No response received.';\n      console.log('‚úÖ Submitting journal for user:', u);\n    } catch (err) {\n      console.error('‚ùå Submit failed:', err);\n    } finally {\n      setEntry('');\n      setParsedTags([]);\n      setSeverityLevel('');\n      setIsProcessing(false);\n      setTimeout(fetchHistory, 300);\n      setRefreshTrigger(prev => prev + 1);\n      // Collapse input on mobile after successful submission\n      if (window.innerWidth <= 768) {\n        setInputExpanded(false);\n      }\n    }\n  };\n\n  // üîΩ Function 5b: Generate Pattern Insight\n  const [processingMessage, setProcessingMessage] = useState(\"\");\n  const handlePatternInsight = async () => {\n    setProcessingMessage(`‚è≥ ${toneName(forcedTone)} is thinking...`);\n    setIsProcessing(true);\n    try {\n      var _userData$user;\n      const {\n        data: userData\n      } = await supabase.auth.getUser();\n      const userId = (_userData$user = userData.user) === null || _userData$user === void 0 ? void 0 : _userData$user.id;\n      const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/generate-pattern-insight`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          user_id: userId,\n          tone_mode: forcedTone // ‚úÖ pass selected voice\n        })\n      });\n      const data = await response.json();\n      if (response.ok) {\n        console.log('‚úÖ Insight:', data.insight);\n        setRefreshTrigger(prev => prev + 1); // üîÅ trigger timeline refresh\n      } else {\n        console.error('‚ùå Insight error:', data.error);\n      }\n    } catch (err) {\n      console.error('‚ùå Insight fetch failed:', err);\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  // üîΩ Function 6: Fetch Past Journals\n  const fetchHistory = async () => {\n    const user = session === null || session === void 0 ? void 0 : session.user;\n    if (!user) return;\n    const {\n      data,\n      error\n    } = await supabase.from('journals').select('id, entry_text, response_text, primary_theme, secondary_theme, tone_mode, timestamp, debug_marker').eq('user_id', user.id).order('timestamp', {\n      ascending: false\n    });\n    if (error) {\n      console.error(\"‚ùå Error fetching history:\", error.message);\n      return;\n    }\n\n    // üîΩ Function 6a: Filter Out No Respose, No debug markers \n\n    const showAll = true; // <== True all entries, False filtered \n    const filtered = showAll ? data || [] : (data || []).filter(entry => {\n      var _entry$response_text, _entry$debug_marker;\n      return ((_entry$response_text = entry.response_text) === null || _entry$response_text === void 0 ? void 0 : _entry$response_text.trim().toLowerCase()) !== 'no response received.' && ((_entry$debug_marker = entry.debug_marker) === null || _entry$debug_marker === void 0 ? void 0 : _entry$debug_marker.trim()) !== '';\n    });\n    // console.log(\"üìú Filtered journal history:\", filtered);  // <== Enable if False \n    setHistory(filtered);\n  };\n  useEffect(() => {\n    if (session) fetchHistory();\n  }, [session]);\n\n  // üîΩ UI State Routing\n  if (!session && !showLogin) {\n    return /*#__PURE__*/_jsxDEV(LandingPage, {\n      onStart: () => setShowLogin(true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 12\n    }, this);\n  }\n  if (!session) {\n    return /*#__PURE__*/_jsxDEV(LoginPage, {\n      onAuthSuccess: (session, username) => {\n        setSession(session);\n        setUsername(username);\n        UsernameStore.set(username); // <--persist\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 7\n    }, this);\n  }\n\n  // üîΩ Function 7: Generate Handoff Summaries  \n\n  // üîΩ Tone Display Utility\n  const displayTone = mode => {\n    const t = mode === null || mode === void 0 ? void 0 : mode.trim().toLowerCase();\n    return t === 'frank' ? 'üî¥ Frank Friend' : 'üü¢ Marcus Aurelius';\n  };\n  const getToneStyle = mode => {\n    const tone = mode === null || mode === void 0 ? void 0 : mode.trim().toLowerCase();\n    switch (tone) {\n      case 'frank':\n      case 'frank friend':\n        return {\n          backgroundColor: '#fff1f1',\n          borderColor: '#cc0000',\n          label: 'üî¥ Tony'\n        };\n      case 'marcus':\n      case 'marcus aurelius':\n        return {\n          backgroundColor: '#f0fdf4',\n          borderColor: '#2e7d32',\n          label: 'üü¢ Marcus Aurelius'\n        };\n      case 'therapist':\n        return {\n          backgroundColor: '#fef6ff',\n          borderColor: '#b755e5',\n          label: 'üü£ Clara'\n        };\n      case 'movies':\n        return {\n          backgroundColor: '#fdfaf6',\n          borderColor: '#ff8c00',\n          label: 'üé¨ Movie Metaphors Man'\n        };\n      case 'verena':\n        return {\n          backgroundColor: '#ffeaf0',\n          borderColor: '#ec407a',\n          label: 'üå∏ Verena'\n        };\n      default:\n        return {\n          backgroundColor: '#eeeeee',\n          borderColor: '#999999',\n          label: '‚ùì Unknown'\n        };\n    }\n  };\n\n  // Centralize tooltip copy in one place\n  const TOOLTIP_TEXT = {\n    pattern: \"Generates a unified insight based on your recent themes, topics, and emotional loops.\",\n    therapist: \"A handoff-style recap of emotional themes, loops, and potential focus areas for therapy.\",\n    mood: \"Visualizes your emotional trends over time. Coming soon.\"\n  };\n\n  // üîΩ UI Rendering\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [showWelcome && welcomeStep === 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        width: '100%',\n        height: '100%',\n        backgroundColor: 'rgba(255,255,255,0.96)',\n        zIndex: 1000,\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center',\n        flexDirection: 'column',\n        padding: '2rem',\n        textAlign: 'center',\n        fontFamily: 'sans-serif',\n        overflowY: 'auto'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          maxWidth: '700px',\n          width: '90%'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          style: {\n            marginBottom: '1rem',\n            fontSize: '1.6rem'\n          },\n          children: \"\\u2728 Choose Your Companion\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 334,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          style: {\n            textAlign: 'left',\n            fontSize: '1rem',\n            marginBottom: '2rem'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"li\", {\n            style: {\n              marginBottom: '1rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"\\uD83D\\uDCAA\\uD83C\\uDF77 Tony\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 337,\n              columnNumber: 15\n            }, this), \" \\u2013 A frank, no-bullshit friend who\\u2019s always honest and supportive, helping you cut through the crap and break free from the loops that keep you stuck.\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 336,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            style: {\n              marginBottom: '1rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"\\uD83E\\uDDD8 Marcus Aurelius\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 340,\n              columnNumber: 15\n            }, this), \" \\u2013 Speaks like the Stoic philosopher himself\\u2014calm, sparse, and deeply rooted in principle. If inspired he may quote from his own journal, \", /*#__PURE__*/_jsxDEV(\"i\", {\n              children: \"Meditations\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 340,\n              columnNumber: 178\n            }, this), \".\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 339,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            style: {\n              marginBottom: '1rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"\\uD83E\\uDE7A Clara\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 343,\n              columnNumber: 15\n            }, this), \" \\u2013 A warm, grounded therapist who sees the pattern beneath the panic.\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 342,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            style: {\n              marginBottom: '1rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"\\uD83C\\uDFAC Movie Metaphor Man\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 346,\n              columnNumber: 15\n            }, this), \" \\u2013 Only thinks in movie metaphors\\u2014no matter what you say. Your problems are part of the hero's journey.\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 345,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            style: {\n              marginBottom: '1.5rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"\\uD83C\\uDF38 Verena\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 349,\n              columnNumber: 15\n            }, this), \" \\u2013 Verena is a clarity-driven career coach who helps you stop spinning your wheels and start building something real.\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 348,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 335,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setShowWelcome(false),\n          style: {\n            padding: '0.8rem 1.5rem',\n            fontSize: '1rem',\n            borderRadius: '6px',\n            backgroundColor: '#374151',\n            color: '#fff',\n            border: 'none',\n            cursor: 'pointer'\n          },\n          children: \"Let\\u2019s begin \\u2192\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 353,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 314,\n      columnNumber: 7\n    }, this), !showWelcome && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-container background-option-1\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            style: {\n              marginBottom: '0.3rem',\n              fontSize: '1.8rem',\n              fontWeight: 600,\n              letterSpacing: '0.5px',\n              color: '#1a1a1a',\n              fontFamily: 'Georgia, serif',\n              textShadow: '0 1px 1px rgba(0,0,0,0.1)'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"mirror-emoji\",\n              role: \"img\",\n              \"aria-label\": \"mirror\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 388,\n              columnNumber: 15\n            }, this), ' ', \"Cognitive Mirror\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 377,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'inline-block',\n              padding: '0.2rem 0.6rem',\n              fontSize: '0.75rem',\n              color: '#555',\n              backgroundColor: '#f5f5f5',\n              border: '1px solid #ddd',\n              borderRadius: '6px',\n              fontStyle: 'italic'\n            },\n            children: \"\\uD83D\\uDEA7 Rough Beta: Responses can take up to a minute. Thanks for your patience.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 393,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 376,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            gap: '0.75rem'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            title: (session === null || session === void 0 ? void 0 : (_session$user = session.user) === null || _session$user === void 0 ? void 0 : _session$user.id) || '',\n            style: {\n              fontSize: '.85rem',\n              color: '#374151',\n              background: '#eef2ff',\n              border: '1px solid #c7d2fe',\n              padding: '4px 8px',\n              borderRadius: '6px',\n              lineHeight: 1.2,\n              whiteSpace: 'nowrap'\n            },\n            children: [\"Signed in as \", /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: username || '‚Äî'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 424,\n              columnNumber: 26\n            }, this), session !== null && session !== void 0 && (_session$user2 = session.user) !== null && _session$user2 !== void 0 && _session$user2.id ? /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                color: '#6b7280',\n                marginLeft: 6\n              },\n              children: [\"(\", session.user.id.slice(0, 8), \")\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 426,\n              columnNumber: 15\n            }, this) : null]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 411,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: async () => {\n              await supabase.auth.signOut();\n              setSession(null);\n            },\n            style: {\n              padding: '6px 10px',\n              borderRadius: 6,\n              border: '1px solid #d1d5db',\n              background: '#fff',\n              cursor: 'pointer'\n            },\n            children: \"Log Out\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 432,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 410,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 375,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `reflection-input-container ${inputExpanded ? 'expanded' : 'collapsed'}`,\n        onClick: () => {\n          console.log('üîç Input container clicked - inputExpanded:', inputExpanded, 'window width:', window.innerWidth);\n          if (!inputExpanded && window.innerWidth <= 768) {\n            console.log('‚úÖ Expanding input on mobile');\n            setInputExpanded(true);\n          }\n        },\n        onTouchStart: e => {\n          console.log('üëÜ Touch start - inputExpanded:', inputExpanded, 'window width:', window.innerWidth);\n          if (!inputExpanded && window.innerWidth <= 768) {\n            console.log('‚úÖ Expanding input on mobile touch');\n            e.preventDefault();\n            setInputExpanded(true);\n          }\n        },\n        style: {\n          touchAction: 'manipulation'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          className: \"reflection-textarea\",\n          rows: \"3\",\n          value: entry,\n          onChange: e => setEntry(e.target.value),\n          onKeyDown: e => {\n            if (e.key === 'Enter' && !e.shiftKey) {\n              e.preventDefault();\n              if (entry.trim() && !isProcessing) {\n                handleSubmit();\n              }\n            }\n            if (e.key === 'Escape' && window.innerWidth <= 768) {\n              setInputExpanded(false);\n            }\n          },\n          placeholder: placeholderPrompt\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 470,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cm-toolbar\",\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            flexWrap: 'wrap',\n            gap: '8px 12px',\n            padding: '6px 10px',\n            background: '#f2f2f2',\n            border: '1px solid #e6e6e6',\n            borderRadius: '6px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cm-actions\",\n            style: {\n              display: 'flex',\n              alignItems: 'center',\n              gap: 8,\n              flexWrap: 'wrap',\n              position: 'relative'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"cm-btn\",\n              onClick: handleSubmit,\n              id: \"reflect-btn\",\n              \"aria-label\": \"Reflect\",\n              type: \"button\",\n              disabled: isProcessing || !entry.trim(),\n              children: \"\\uD83E\\uDDE0 Reflect\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 514,\n              columnNumber: 15\n            }, this), window.innerWidth <= 768 && inputExpanded && /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"cm-btn\",\n              onClick: () => setInputExpanded(false),\n              \"aria-label\": \"Close\",\n              type: \"button\",\n              children: \"\\u2715 Close\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 526,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"cm-btn\",\n              onClick: handlePatternInsight,\n              onMouseEnter: () => setTooltipVisible('pattern'),\n              onMouseLeave: () => setTooltipVisible(null),\n              children: \"\\uD83E\\uDDED See Pattern Insight\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 535,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"cm-btn\",\n              onClick: () => setShowSummary(true),\n              onMouseEnter: () => setTooltipVisible('therapist'),\n              onMouseLeave: () => setTooltipVisible(null),\n              children: \"\\uD83E\\uDE7A Therapist Summary\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 544,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"cm-btn\",\n              onClick: handleOpenMoodTracker /* your existing handler */,\n              onMouseEnter: () => setTooltipVisible('mood'),\n              onMouseLeave: () => setTooltipVisible(null),\n              children: \"\\uD83D\\uDCCA Mood Tracker\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 553,\n              columnNumber: 15\n            }, this), tooltipVisible && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                position: 'absolute',\n                top: '-2.4rem',\n                left: '50%',\n                transform: 'translateX(-50%)',\n                background: '#333',\n                color: '#fff',\n                padding: '0.4rem 0.6rem',\n                borderRadius: 6,\n                fontSize: '0.75rem',\n                whiteSpace: 'nowrap',\n                zIndex: 20,\n                pointerEvents: 'none'\n              },\n              children: [tooltipVisible === 'pattern' && 'Generates a unified insight based on your recent themes, topics, and emotional loops.', tooltipVisible === 'therapist' && 'A handoff-style recap of emotional themes, loops, and potential focus areas for therapy.', tooltipVisible === 'mood' && 'Visualizes your emotional trends over time.']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 564,\n              columnNumber: 17\n            }, this), isListening && /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"\\uD83C\\uDFA7 Listening\\u2026\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 588,\n              columnNumber: 31\n            }, this), isProcessing && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"processing-message\",\n              children: [\"\\u23F3 \", toneName(forcedTone), \" is thinking\", /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"dots\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 591,\n                columnNumber: 55\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 590,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 503,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cm-voice\",\n            style: {\n              display: 'flex',\n              alignItems: 'center',\n              gap: '8px 10px',\n              flexWrap: 'wrap',\n              borderLeft: '1px solid #e6e6e6',\n              paddingLeft: 12\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              style: {\n                marginRight: '0.35rem'\n              },\n              children: \"\\uD83D\\uDDE3\\uFE0F Voice:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 608,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              value: forcedTone,\n              onChange: handleToneChange,\n              \"aria-label\": \"Select voice\",\n              style: {\n                minWidth: 120,\n                maxWidth: 160,\n                padding: '6px 8px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"therapist\",\n                children: \"Clara\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 615,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"marcus\",\n                children: \"Marcus\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 616,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"frank\",\n                children: \"Tony\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 617,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"movies\",\n                children: \"Movies\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 618,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"verena\",\n                children: \"Verena\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 619,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 609,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cm-tone-desc\",\n              \"aria-live\": \"polite\",\n              children: toneDescription\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 621,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 597,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 489,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 451,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          flex: 1,\n          overflowY: 'auto',\n          paddingBottom: window.innerWidth <= 768 ? '0.5rem' : '2rem',\n          WebkitOverflowScrolling: 'touch',\n          // Smooth scrolling on iOS\n          // Remove smooth scroll to prevent zoom interference\n          scrollBehavior: 'auto',\n          touchAction: 'pan-x pan-y pinch-zoom' // Allow pinch-zoom\n        },\n        children: /*#__PURE__*/_jsxDEV(JournalTimeline, {\n          userId: session === null || session === void 0 ? void 0 : (_session$user3 = session.user) === null || _session$user3 === void 0 ? void 0 : _session$user3.id,\n          refreshTrigger: refreshTrigger,\n          styleVariant: styleVariant\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 643,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 634,\n        columnNumber: 9\n      }, this), showSummary && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: '1rem'\n        },\n        children: /*#__PURE__*/_jsxDEV(SummaryViewer, {\n          history: history,\n          onClose: () => setShowSummary(false)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 649,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 648,\n        columnNumber: 11\n      }, this), showMoodTracker && /*#__PURE__*/_jsxDEV(MoodModal, {\n        userId: session === null || session === void 0 ? void 0 : (_session$user4 = session.user) === null || _session$user4 === void 0 ? void 0 : _session$user4.id,\n        onClose: handleCloseMoodTracker\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 654,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 373,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n_s2(App, \"M5hRrlGxH9GNLL0AwvL3LcAkj8I=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useEffect","useState","SummaryViewer","supabase","UsernameStore","getBootSession","subscribeAuth","LandingPage","LoginPage","JournalTimeline","MoodModal","jsxDEV","_jsxDEV","Fragment","_Fragment","App","_s2","_session$user","_session$user2","_session$user3","_session$user4","toneDescriptions","therapist","marcus","frank","movies","verena","forcedTone","setForcedTone","toneDescription","setToneDescription","handleToneChange","e","val","target","value","toneName","t","showLogin","setShowLogin","session","setSession","entry","setEntry","history","setHistory","tooltip","setTooltip","latestEntryId","setLatestEntryId","showSummary","setShowSummary","loadingSummary","setLoadingSummary","summary","setSummary","parsedTags","setParsedTags","severityLevel","setSeverityLevel","isProcessing","setIsProcessing","recognition","setRecognition","inputExpanded","setInputExpanded","isListening","setIsListening","prompts","showGroupedView","setShowGroupedView","placeholderPrompt","setPlaceholderPrompt","Math","floor","random","length","refreshTrigger","setRefreshTrigger","transcriptBuffer","tooltipVisible","setTooltipVisible","styleVariant","setStyleVariant","showWelcome","setShowWelcome","welcomeStep","setWelcomeStep","username","setUsername","showMoodTracker","setShowMoodTracker","handleCloseMoodTracker","handleOpenMoodTracker","saved","get","console","log","process","env","REACT_APP_ENV","REACT_APP_BACKEND_URL","REACT_APP_SUPABASE_URL","hasTriggeredSummary","localStorage","getItem","setItem","fetch","then","res","text","stop","handleSubmit","_s","warn","u","trim","s","user","setProcessingMessage","debug_marker","toString","substring","userId","id","method","headers","body","JSON","stringify","entry_text","tone_mode","user_id","data","json","responseText","response","err","error","setTimeout","fetchHistory","prev","window","innerWidth","processingMessage","handlePatternInsight","_userData$user","userData","auth","getUser","ok","insight","from","select","eq","order","ascending","message","showAll","filtered","filter","_entry$response_text","_entry$debug_marker","response_text","toLowerCase","onStart","fileName","_jsxFileName","lineNumber","columnNumber","onAuthSuccess","set","displayTone","mode","getToneStyle","tone","backgroundColor","borderColor","label","TOOLTIP_TEXT","pattern","mood","children","style","position","top","left","width","height","zIndex","display","justifyContent","alignItems","flexDirection","padding","textAlign","fontFamily","overflowY","maxWidth","marginBottom","fontSize","onClick","borderRadius","color","border","cursor","className","fontWeight","letterSpacing","textShadow","role","fontStyle","gap","title","background","lineHeight","whiteSpace","marginLeft","slice","signOut","onTouchStart","preventDefault","touchAction","rows","onChange","onKeyDown","key","shiftKey","placeholder","flexWrap","type","disabled","onMouseEnter","onMouseLeave","transform","pointerEvents","borderLeft","paddingLeft","marginRight","minWidth","flex","paddingBottom","WebkitOverflowScrolling","scrollBehavior","marginTop","onClose","_c","$RefreshReg$"],"sources":["/Users/mac/Projects/cognitive-mirror-frontend-dev/src/App.js"],"sourcesContent":["// üîº Imports and Setup      \nimport React, { useEffect, useState } from 'react'; \nimport SummaryViewer from './SummaryViewer'; \nimport { supabase, UsernameStore, getBootSession, subscribeAuth } from './supabaseClient';\nimport './App.css';\n// import DemoSofia from './pages/DemoSofia';\nimport LandingPage from './LandingPage';\nimport LoginPage from './LoginPage';\nimport JournalTimeline from './components/JournalTimeline';\nimport MoodModal from './components/MoodModal'; \n\nconst App = () => {\n\n  // --- Tone descriptions map ---\n  const toneDescriptions = {\n    therapist: \"ü©∫ Clara ‚Äì A warm, grounded therapist who sees the pattern beneath the panic.\",\n    marcus: \"üßò Marcus ‚Äì Speaks like the Stoic philosopher himself. Will quote Meditations.\",\n    frank: \"üí™üç∑ Tony ‚Äì A frank, no-bullshit friend who tells you what you need to hear.\",\n    movies: \"üé¨ Movies ‚Äì A movie buff who only speaks through movie metaphors.\",\n    verena: \"üå∏ Verena ‚Äì A clarity-driven life coach unphased by self-pity.\"\n  };\n\n  // Default to Clara\n  const [forcedTone, setForcedTone] = useState(\"therapist\");\n  // Keep a visible description bound to the current selection\n  const [toneDescription, setToneDescription] = useState(toneDescriptions[\"therapist\"]);\n\n  const handleToneChange = (e) => {\n    const val = e.target.value;\n    setForcedTone(val);\n    setToneDescription(toneDescriptions[val] || \"\");\n  };\n\n  const toneName = (t) =>\n  ({ therapist: 'Clara', marcus: 'Marcus', frank: 'Tony', movies: 'Movies', verena: 'Verena' }[t] || 'Mirror');\n\n  // üîΩ Existing states (no change to their order beyond moving forcedTone here)\n  const [showLogin, setShowLogin] = useState(false);\n  const [session, setSession] = useState(null);\n  const [entry, setEntry] = useState('');\n  const [history, setHistory] = useState([]);\n  const [tooltip, setTooltip] = useState(\"ü©∫ Clara ‚Äì A warm, grounded therapist who sees the pattern beneath the panic.\");\n  const [latestEntryId, setLatestEntryId] = useState(null);\n  const [showSummary, setShowSummary] = useState(false);\n  const [loadingSummary, setLoadingSummary] = useState(false);\n  const [summary, setSummary] = useState('');\n  const [parsedTags, setParsedTags] = useState([]);\n  const [severityLevel, setSeverityLevel] = useState('');\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [recognition, setRecognition] = useState(null);\n  const [inputExpanded, setInputExpanded] = useState(false);\n  const [isListening, setIsListening] = useState(false);\n  const prompts = [\"What‚Äôs shaking sugar?\"];\n  const [showGroupedView, setShowGroupedView] = useState(false);\n  const [placeholderPrompt, setPlaceholderPrompt] = useState(() =>\n    prompts[Math.floor(Math.random() * prompts.length)] \n  );\n  const [refreshTrigger, setRefreshTrigger] = useState(0);\n  let transcriptBuffer = '';\n  const [tooltipVisible, setTooltipVisible] = useState(null); // 'pattern' | 'therapist' | 'mood' | null\n  const [styleVariant, setStyleVariant] = useState(\"D\")\n  const [showWelcome, setShowWelcome] = useState(false);\n  const [welcomeStep, setWelcomeStep] =useState(1);\n  const [username, setUsername] = useState('');\n  const [showMoodTracker, setShowMoodTracker] = useState(false);\n  const handleCloseMoodTracker = () => setShowMoodTracker(false);\n  const handleOpenMoodTracker = () => setShowMoodTracker(true);\n\n  // üîΩ Function 1: Load Saved Username (rehydrate)\n  useEffect(() => {\n    const saved = UsernameStore.get();\n    if (saved) setUsername(saved);\n  }, []);\n\n    // Log environment on startup\n  useEffect(() => {\n    console.log(`üöÄ Running in ${process.env.REACT_APP_ENV || 'unknown'} mode`);\n    console.log(`üõ∞Ô∏è Backend: ${process.env.REACT_APP_BACKEND_URL || 'unset'}`);\n    console.log(`üóÑÔ∏è Supabase: ${process.env.REACT_APP_SUPABASE_URL || 'unset'}`);\n  }, []);\n  \n  // üîΩ Function 3: Show Summary Trigger\n  useEffect(() => {\n    const hasTriggeredSummary = localStorage.getItem('hasTriggeredSummary');\n    if (!hasTriggeredSummary && history.length >= 5) {\n      setShowSummary(true);\n      localStorage.setItem('hasTriggeredSummary', 'true');\n    }\n  }, [history]);\n\n   // üîΩ Function 3a: Build Current Commit Tag \n  useEffect(() => {\n    fetch('/build-version.txt')\n      .then(res => res.text())\n      .then(text => {\n         console.log(\"üõ†Ô∏è App.js version:\", text);\n         // console.log(`üß± Frontend build version: ${text}`);\n      });\n  }, []);\n\n  // üîΩ Function 4: Auth Setup (boot + subscribe once)\n    useEffect(() => {\n      let stop = () => {};\n      (async () => {\n        setSession(await getBootSession());\n        stop = subscribeAuth(setSession);\n      })();\n      return () => stop();\n    }, []);\n\n // üîΩ Function 5: Submit New Journal Entry (username/session‚Äìsafe)\n  const handleSubmit = async () => {\n    console.warn(\"üß™ handleSubmit called!\");\n\n    // Always read a stable username\n    const u = (username || UsernameStore.get() || '').trim();\n\n    // Make sure we have a session\n    let s = session;\n    if (!s) {\n      s = await getBootSession();\n      if (s) setSession(s);\n    }\n\n    // Guard rails: must have session + entry + username\n    if (!s?.user || !entry.trim() || !u) return;\n\n    setProcessingMessage(`‚è≥ ${toneName(forcedTone)} is thinking...`);\n    setIsProcessing(true);\n\n    const debug_marker = Math.random().toString(36).substring(2, 8);\n    const userId = s.user.id;\n\n    try {\n      const res = await fetch(`${process.env.REACT_APP_BACKEND_URL}/journal-entry`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          entry_text: entry,\n          tone_mode: forcedTone,\n          username: u,            // <-- use stable value\n          user_id: userId,\n          debug_marker,\n        }),\n      });\n\n      const data = await res.json();\n      const responseText = data.response || 'No response received.';\n      console.log('‚úÖ Submitting journal for user:', u);\n    } catch (err) {\n      console.error('‚ùå Submit failed:', err);\n    } finally {\n      setEntry('');\n      setParsedTags([]);\n      setSeverityLevel('');\n      setIsProcessing(false);\n      setTimeout(fetchHistory, 300);\n      setRefreshTrigger(prev => prev + 1);\n      // Collapse input on mobile after successful submission\n      if (window.innerWidth <= 768) {\n        setInputExpanded(false);\n      }\n    }\n  };\n\n  // üîΩ Function 5b: Generate Pattern Insight\n  const [processingMessage, setProcessingMessage] = useState(\"\");\n  \n  const handlePatternInsight = async () => {\n    setProcessingMessage(`‚è≥ ${toneName(forcedTone)} is thinking...`);\n    setIsProcessing(true);\n  \n    try {\n      const { data: userData } = await supabase.auth.getUser();\n      const userId = userData.user?.id;\n      \n      const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/generate-pattern-insight`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          user_id: userId,\n          tone_mode: forcedTone // ‚úÖ pass selected voice\n        })\n      });\n  \n      const data = await response.json();\n  \n      if (response.ok) {\n        console.log('‚úÖ Insight:', data.insight);\n        setRefreshTrigger(prev => prev + 1); // üîÅ trigger timeline refresh\n      } else {\n        console.error('‚ùå Insight error:', data.error);\n      }\n    } catch (err) {\n      console.error('‚ùå Insight fetch failed:', err);\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n  \n   // üîΩ Function 6: Fetch Past Journals\n  const fetchHistory = async () => {\n    const user = session?.user;\n    if (!user) return;\n    const { data, error } = await supabase\n      .from('journals')\n      .select('id, entry_text, response_text, primary_theme, secondary_theme, tone_mode, timestamp, debug_marker')\n      .eq('user_id', user.id)\n      .order('timestamp', { ascending: false });\n      \n    if (error) {\n    console.error(\"‚ùå Error fetching history:\", error.message);\n    return;\n  }\n\n  // üîΩ Function 6a: Filter Out No Respose, No debug markers \n\n  const showAll = true; // <== True all entries, False filtered \n  const filtered = showAll\n    ? (data || [])\n    : (data || []).filter(entry =>\n    entry.response_text?.trim().toLowerCase() !== 'no response received.' &&\n    entry.debug_marker?.trim() !== ''\n  );\n  // console.log(\"üìú Filtered journal history:\", filtered);  // <== Enable if False \n  setHistory(filtered);\n};\n\n  useEffect(() => {\n    if (session) fetchHistory();\n  }, [session]);\n\n  // üîΩ UI State Routing\n  if (!session && !showLogin) {\n    return <LandingPage onStart={() => setShowLogin(true)} />;\n  }\n\n  if (!session) {\n    return (\n      <LoginPage\n        onAuthSuccess={(session, username) => {\n          setSession(session);\n          setUsername(username);\n          UsernameStore.set(username); // <--persist\n        }}\n      />\n    );\n  }\n\n// üîΩ Function 7: Generate Handoff Summaries  \n\n  // üîΩ Tone Display Utility\n  const displayTone = (mode) => {\n    const t = mode?.trim().toLowerCase();\n    return t === 'frank' ? 'üî¥ Frank Friend' : 'üü¢ Marcus Aurelius';\n  };\n\n  const getToneStyle = (mode) => {\n    const tone = mode?.trim().toLowerCase();\n    switch (tone) {\n      case 'frank':\n      case 'frank friend':\n        return {\n          backgroundColor: '#fff1f1',\n          borderColor: '#cc0000',\n          label: 'üî¥ Tony',\n        };\n      case 'marcus':\n      case 'marcus aurelius':\n        return {\n          backgroundColor: '#f0fdf4',\n          borderColor: '#2e7d32',\n          label: 'üü¢ Marcus Aurelius',\n        };\n      case 'therapist':\n        return {\n          backgroundColor: '#fef6ff',\n          borderColor: '#b755e5',\n          label: 'üü£ Clara',\n        };\n      case 'movies':\n        return {\n          backgroundColor: '#fdfaf6',\n          borderColor: '#ff8c00',\n          label: 'üé¨ Movie Metaphors Man',\n        };\n      case 'verena':\n          return {\n            backgroundColor: '#ffeaf0',\n            borderColor: '#ec407a',\n            label: 'üå∏ Verena',\n        };  \n      default:\n        return {\n          backgroundColor: '#eeeeee',\n          borderColor: '#999999',\n          label: '‚ùì Unknown',\n        };\n    }\n  };\n\n    // Centralize tooltip copy in one place\n    const TOOLTIP_TEXT = {\n      pattern: \"Generates a unified insight based on your recent themes, topics, and emotional loops.\",\n      therapist: \"A handoff-style recap of emotional themes, loops, and potential focus areas for therapy.\",\n      mood: \"Visualizes your emotional trends over time. Coming soon.\"\n    };\n\n// üîΩ UI Rendering\nreturn (\n  <>\n    {/* Step 1: Voice Introduction + Begin */}\n    {showWelcome && welcomeStep === 1 && (\n      <div\n        style={{\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          width: '100%',\n          height: '100%',\n          backgroundColor: 'rgba(255,255,255,0.96)',\n          zIndex: 1000,\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          flexDirection: 'column',\n          padding: '2rem',\n          textAlign: 'center',\n          fontFamily: 'sans-serif',\n          overflowY: 'auto'\n        }}\n      >\n        <div style={{ maxWidth: '700px', width: '90%' }}>\n          <h2 style={{ marginBottom: '1rem', fontSize: '1.6rem' }}>‚ú® Choose Your Companion</h2>\n          <ul style={{ textAlign: 'left', fontSize: '1rem', marginBottom: '2rem' }}>\n            <li style={{ marginBottom: '1rem' }}>\n              <b>üí™üç∑ Tony</b> ‚Äì A frank, no-bullshit friend who‚Äôs always honest and supportive, helping you cut through the crap and break free from the loops that keep you stuck.\n            </li>\n            <li style={{ marginBottom: '1rem' }}>\n              <b>üßò Marcus Aurelius</b> ‚Äì Speaks like the Stoic philosopher himself‚Äîcalm, sparse, and deeply rooted in principle. If inspired he may quote from his own journal, <i>Meditations</i>.\n            </li>\n            <li style={{ marginBottom: '1rem' }}>\n              <b>ü©∫ Clara</b> ‚Äì A warm, grounded therapist who sees the pattern beneath the panic.\n            </li>\n            <li style={{ marginBottom: '1rem' }}>\n              <b>üé¨ Movie Metaphor Man</b> ‚Äì Only thinks in movie metaphors‚Äîno matter what you say. Your problems are part of the hero's journey.\n            </li>\n            <li style={{ marginBottom: '1.5rem' }}>\n              <b>üå∏ Verena</b> ‚Äì Verena is a clarity-driven career coach who helps you stop spinning your wheels and start building something real.\n            </li>\n          </ul>\n\n          <button\n            onClick={() => setShowWelcome(false)}\n            style={{\n              padding: '0.8rem 1.5rem',\n              fontSize: '1rem',\n              borderRadius: '6px',\n              backgroundColor: '#374151',\n              color: '#fff',\n              border: 'none',\n              cursor: 'pointer'\n            }}\n          >\n            Let‚Äôs begin ‚Üí\n          </button>\n        </div>\n      </div>\n    )}\n\n    {/* MAIN APP INTERFACE ‚Äî Only render when welcome is dismissed */}\n    {!showWelcome && (\n      <div className=\"chat-container background-option-1\">\n        {/* Header with Logout */}\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n          <div>\n            <h1\n              style={{\n                marginBottom: '0.3rem',\n                fontSize: '1.8rem',\n                fontWeight: 600,\n                letterSpacing: '0.5px',\n                color: '#1a1a1a',\n                fontFamily: 'Georgia, serif',\n                textShadow: '0 1px 1px rgba(0,0,0,0.1)'\n              }}\n            >\n              <span className=\"mirror-emoji\" role=\"img\" aria-label=\"mirror\">\n              </span>{' '}\n              Cognitive Mirror\n            </h1>\n\n            <div\n              style={{\n                display: 'inline-block',\n                padding: '0.2rem 0.6rem',\n                fontSize: '0.75rem',\n                color: '#555',\n                backgroundColor: '#f5f5f5',\n                border: '1px solid #ddd',\n                borderRadius: '6px',\n                fontStyle: 'italic'\n              }}\n            >\n               üöß Rough Beta: Responses can take up to a minute. Thanks for your patience.\n            </div>\n          </div>\n  \n        {/* Username and Logout Button Placement Top Right */}\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem' }}>\n          <div\n            title={session?.user?.id || ''}\n            style={{\n              fontSize: '.85rem',\n              color: '#374151',\n              background: '#eef2ff',\n              border: '1px solid #c7d2fe',\n              padding: '4px 8px',\n              borderRadius: '6px',\n              lineHeight: 1.2,\n              whiteSpace: 'nowrap'\n            }}\n          >\n            Signed in as <strong>{username || '‚Äî'}</strong>\n            {session?.user?.id ? (\n              <span style={{ color: '#6b7280', marginLeft: 6 }}>\n                ({(session.user.id).slice(0, 8)})\n              </span>\n            ) : null}\n          </div>\n\n          <button\n            onClick={async () => {\n              await supabase.auth.signOut();\n              setSession(null);\n            }}\n            style={{\n              padding: '6px 10px',\n              borderRadius: 6,\n              border: '1px solid #d1d5db',\n              background: '#fff',\n              cursor: 'pointer'\n            }}\n          >\n            Log Out\n          </button>\n        </div>\n        </div>\n\n        {/* Sticky Input Bar (fixed) */}\n        <div\n          className={`reflection-input-container ${inputExpanded ? 'expanded' : 'collapsed'}`}\n          onClick={() => {\n            console.log('üîç Input container clicked - inputExpanded:', inputExpanded, 'window width:', window.innerWidth);\n            if (!inputExpanded && window.innerWidth <= 768) {\n              console.log('‚úÖ Expanding input on mobile');\n              setInputExpanded(true);\n            }\n          }}\n          onTouchStart={(e) => {\n            console.log('üëÜ Touch start - inputExpanded:', inputExpanded, 'window width:', window.innerWidth);\n            if (!inputExpanded && window.innerWidth <= 768) {\n              console.log('‚úÖ Expanding input on mobile touch');\n              e.preventDefault();\n              setInputExpanded(true);\n            }\n          }}\n          style={{ touchAction: 'manipulation' }}\n        >\n          <textarea\n          className=\"reflection-textarea\"\n          rows=\"3\"\n          value={entry}\n          onChange={(e) => setEntry(e.target.value)}\n          onKeyDown={(e) => {\n            if (e.key === 'Enter' && !e.shiftKey) {\n              e.preventDefault();\n              if (entry.trim() && !isProcessing) {\n                handleSubmit();\n              }\n            }\n            if (e.key === 'Escape' && window.innerWidth <= 768) {\n              setInputExpanded(false);\n            }\n          }}\n          placeholder={placeholderPrompt}\n        />\n          {/* Toolbar row: all action buttons on one line */}\n          <div\n            className=\"cm-toolbar\"\n            style={{\n              display: 'flex',\n              alignItems: 'center',\n              flexWrap: 'wrap',\n              gap: '8px 12px',\n              padding: '6px 10px',\n              background: '#f2f2f2',\n              border: '1px solid #e6e6e6',\n              borderRadius: '6px'\n            }}\n          >\n            {/* Action buttons (one row) */}\n            <div\n              className=\"cm-actions\"\n              style={{ display: 'flex', alignItems: 'center', gap: 8, flexWrap: 'wrap', position: 'relative' }}\n            >\n              {/* <button className=\"cm-btn\" onClick={startListening} disabled={isListening}>\n                üéôÔ∏è Start\n              </button>\n              <button className=\"cm-btn\" onClick={stopListening} disabled={!isListening}>\n                üõë Stop\n          </button> */}\n          \n              <button \n                  className=\"cm-btn\" \n                  onClick={handleSubmit}\n                  id=\"reflect-btn\"\n                  aria-label=\"Reflect\"\n                  type=\"button\" \n                  disabled={isProcessing || !entry.trim()}>\n                üß† Reflect\n              </button>\n\n              {/* Mobile close button when expanded */}\n              {window.innerWidth <= 768 && inputExpanded && (\n                <button \n                  className=\"cm-btn\" \n                  onClick={() => setInputExpanded(false)}\n                  aria-label=\"Close\"\n                  type=\"button\">\n                  ‚úï Close\n                </button>\n              )}\n\n              <button\n                className=\"cm-btn\"\n                onClick={handlePatternInsight}\n                onMouseEnter={() => setTooltipVisible('pattern')}\n                onMouseLeave={() => setTooltipVisible(null)}\n              >\n                üß≠ See Pattern Insight\n              </button>\n\n              <button\n                className=\"cm-btn\"\n                onClick={() => setShowSummary(true)}\n                onMouseEnter={() => setTooltipVisible('therapist')}\n                onMouseLeave={() => setTooltipVisible(null)}\n              >\n                ü©∫ Therapist Summary\n              </button>\n\n              <button\n                className=\"cm-btn\"\n                onClick={handleOpenMoodTracker /* your existing handler */}\n                onMouseEnter={() => setTooltipVisible('mood')}\n                onMouseLeave={() => setTooltipVisible(null)}\n              >\n                üìä Mood Tracker\n              </button>\n\n              {/* Shared tooltip renderer for the three buttons */}\n              {tooltipVisible && (\n                <div\n                  style={{\n                    position: 'absolute',\n                    top: '-2.4rem',\n                    left: '50%',\n                    transform: 'translateX(-50%)',\n                    background: '#333',\n                    color: '#fff',\n                    padding: '0.4rem 0.6rem',\n                    borderRadius: 6,\n                    fontSize: '0.75rem',\n                    whiteSpace: 'nowrap',\n                    zIndex: 20,\n                    pointerEvents: 'none'\n                  }}\n                >\n                  {tooltipVisible === 'pattern' &&\n                    'Generates a unified insight based on your recent themes, topics, and emotional loops.'}\n                  {tooltipVisible === 'therapist' &&\n                    'A handoff-style recap of emotional themes, loops, and potential focus areas for therapy.'}\n                  {tooltipVisible === 'mood' && 'Visualizes your emotional trends over time.'}\n                </div>\n              )}\n\n              {isListening && <span>üéß Listening‚Ä¶</span>}\n              {isProcessing && (\n                <div className=\"processing-message\">\n                  ‚è≥ {toneName(forcedTone)} is thinking<span className=\"dots\"></span>\n                </div>\n              )}\n            </div>\n\n            {/* Voice cluster with subtle separation and a narrower select */}\n            <div\n              className=\"cm-voice\"\n              style={{\n                display: 'flex',\n                alignItems: 'center',\n                gap: '8px 10px',\n                flexWrap: 'wrap',\n                borderLeft: '1px solid #e6e6e6',\n                paddingLeft: 12\n              }}\n            >\n              <label style={{ marginRight: '0.35rem' }}>üó£Ô∏è Voice:</label>\n              <select\n                value={forcedTone}\n                onChange={handleToneChange}\n                aria-label=\"Select voice\"\n                style={{ minWidth: 120, maxWidth: 160, padding: '6px 8px' }}\n              >\n                <option value=\"therapist\">Clara</option>\n                <option value=\"marcus\">Marcus</option>\n                <option value=\"frank\">Tony</option>\n                <option value=\"movies\">Movies</option>\n                <option value=\"verena\">Verena</option>\n              </select>\n              <div\n                className=\"cm-tone-desc\"\n                aria-live=\"polite\"\n              >\n                {toneDescription}\n              </div>\n            </div>\n          </div>\n          {/* END toolbar */}\n        </div>\n        {/* END fixed input container */}\n\n        {/* Timeline (outside the fixed container) */}\n        <div style={{ \n          flex: 1, \n          overflowY: 'auto', \n          paddingBottom: window.innerWidth <= 768 ? '0.5rem' : '2rem',\n          WebkitOverflowScrolling: 'touch', // Smooth scrolling on iOS\n          // Remove smooth scroll to prevent zoom interference\n          scrollBehavior: 'auto',\n          touchAction: 'pan-x pan-y pinch-zoom' // Allow pinch-zoom\n        }}>\n          <JournalTimeline userId={session?.user?.id} refreshTrigger={refreshTrigger} styleVariant={styleVariant} />\n        </div>\n\n        {/* Summary Viewer */}\n        {showSummary && (\n          <div style={{ marginTop: '1rem' }}>\n            <SummaryViewer history={history} onClose={() => setShowSummary(false)} />\n          </div>\n        )}\n        {/* Mood Tracker Model */}\n        {showMoodTracker && (\n          <MoodModal\n            userId={session?.user?.id}\n            onClose={handleCloseMoodTracker}\n          />\n        )}\n      </div>\n    )}\n  </>\n);\n}\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}