{"ast":null,"code":"var _jsxFileName = \"/Users/mac/Projects/cognitive-mirror-frontend-dev/src/App.js\",\n  _s4 = $RefreshSig$();\n// üîº Imports and Setup      \nimport React, { useEffect, useState } from 'react';\nimport SummaryViewer from './SummaryViewer';\nimport { supabase, UsernameStore, getBootSession, subscribeAuth } from './supabaseClient';\nimport './App.css';\n// import DemoSofia from './pages/DemoSofia';\nimport LandingPage from './LandingPage';\nimport LoginPage from './LoginPage';\nimport JournalTimeline from './components/JournalTimeline';\nimport MoodModal from './components/MoodModal';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst App = () => {\n  _s4();\n  var _session$user, _session$user2, _session$user3, _session$user4;\n  // --- Tone descriptions map ---\n  const toneDescriptions = {\n    therapist: \"ü©∫ Clara ‚Äì A warm, grounded therapist who sees the pattern beneath the panic.\",\n    marcus: \"üßò Marcus ‚Äì Speaks like the Stoic philosopher himself. Will quote Meditations.\",\n    frank: \"üí™üç∑ Tony ‚Äì A frank, no-bullshit friend who tells you what you need to hear.\",\n    movies: \"üé¨ Movies ‚Äì A movie buff who only speaks through movie metaphors.\",\n    verena: \"üå∏ Verena ‚Äì A clarity-driven life coach unphased by self-pity.\"\n  };\n\n  // Default to Clara\n  const [forcedTone, setForcedTone] = useState(\"therapist\");\n  // Keep a visible description bound to the current selection\n  const [toneDescription, setToneDescription] = useState(toneDescriptions[\"therapist\"]);\n  const handleToneChange = e => {\n    const val = e.target.value;\n    setForcedTone(val);\n    setToneDescription(toneDescriptions[val] || \"\");\n  };\n  const toneName = t => ({\n    therapist: 'Clara',\n    marcus: 'Marcus',\n    frank: 'Tony',\n    movies: 'Movies',\n    verena: 'Verena'\n  })[t] || 'Mirror';\n\n  // üîΩ Existing states (no change to their order beyond moving forcedTone here)\n  const [showLogin, setShowLogin] = useState(false);\n  const [session, setSession] = useState(null);\n  const [entry, setEntry] = useState('');\n  const [history, setHistory] = useState([]);\n  const [tooltip, setTooltip] = useState(\"ü©∫ Clara ‚Äì A warm, grounded therapist who sees the pattern beneath the panic.\");\n  const [latestEntryId, setLatestEntryId] = useState(null);\n  const [showSummary, setShowSummary] = useState(false);\n  const [loadingSummary, setLoadingSummary] = useState(false);\n  const [summary, setSummary] = useState('');\n  const [parsedTags, setParsedTags] = useState([]);\n  const [severityLevel, setSeverityLevel] = useState('');\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [recognition, setRecognition] = useState(null);\n  const [inputExpanded, setInputExpanded] = useState(false);\n  const [debugInfo, setDebugInfo] = useState('');\n  const [isListening, setIsListening] = useState(false);\n  const prompts = [\"What‚Äôs shaking sugar?\"];\n  const [showGroupedView, setShowGroupedView] = useState(false);\n  const [placeholderPrompt, setPlaceholderPrompt] = useState(() => prompts[Math.floor(Math.random() * prompts.length)]);\n  const [refreshTrigger, setRefreshTrigger] = useState(0);\n  let transcriptBuffer = '';\n  const [tooltipVisible, setTooltipVisible] = useState(null); // 'pattern' | 'therapist' | 'mood' | null\n  const [styleVariant, setStyleVariant] = useState(\"D\");\n  const [showWelcome, setShowWelcome] = useState(false);\n  const [welcomeStep, setWelcomeStep] = useState(1);\n  const [username, setUsername] = useState('');\n  const [showMoodTracker, setShowMoodTracker] = useState(false);\n  const handleCloseMoodTracker = () => setShowMoodTracker(false);\n  const handleOpenMoodTracker = () => setShowMoodTracker(true);\n\n  // üîΩ Function 1: Load Saved Username (rehydrate)\n  useEffect(() => {\n    const saved = UsernameStore.get();\n    if (saved) setUsername(saved);\n  }, []);\n\n  // Log environment on startup\n  useEffect(() => {\n    console.log(`üöÄ Running in ${process.env.REACT_APP_ENV || 'unknown'} mode`);\n    console.log(`üõ∞Ô∏è Backend: ${process.env.REACT_APP_BACKEND_URL || 'unset'}`);\n    console.log(`üóÑÔ∏è Supabase: ${process.env.REACT_APP_SUPABASE_URL || 'unset'}`);\n  }, []);\n\n  // üîΩ Function 3: Show Summary Trigger\n  useEffect(() => {\n    const hasTriggeredSummary = localStorage.getItem('hasTriggeredSummary');\n    if (!hasTriggeredSummary && history.length >= 5) {\n      setShowSummary(true);\n      localStorage.setItem('hasTriggeredSummary', 'true');\n    }\n  }, [history]);\n\n  // üîΩ Function 3a: Build Current Commit Tag \n  useEffect(() => {\n    fetch('/build-version.txt').then(res => res.text()).then(text => {\n      console.log(\"üõ†Ô∏è App.js version:\", text);\n      // console.log(`üß± Frontend build version: ${text}`);\n    });\n  }, []);\n\n  // üîΩ Function 4: Auth Setup (boot + subscribe once)\n  useEffect(() => {\n    let stop = () => {};\n    (async () => {\n      setSession(await getBootSession());\n      stop = subscribeAuth(setSession);\n    })();\n    return () => stop();\n  }, []);\n\n  // üîΩ Function 5: Submit New Journal Entry (username/session‚Äìsafe)\n  const handleSubmit = async () => {\n    var _s, _s2, _s2$user, _s3;\n    console.warn(\"üß™ handleSubmit called from device width:\", window.innerWidth);\n    console.log(\"üìù Entry content:\", entry.trim());\n\n    // Always read a stable username\n    const u = (username || UsernameStore.get() || '').trim();\n\n    // Make sure we have a session\n    let s = session;\n    if (!s) {\n      s = await getBootSession();\n      if (s) setSession(s);\n    }\n\n    // Guard rails: must have session + entry + username\n    console.log('üîç Guard rails check:', {\n      hasSession: !!((_s = s) !== null && _s !== void 0 && _s.user),\n      hasEntry: !!entry.trim(),\n      hasUsername: !!u,\n      sessionUser: (_s2 = s) === null || _s2 === void 0 ? void 0 : (_s2$user = _s2.user) === null || _s2$user === void 0 ? void 0 : _s2$user.id,\n      username: u,\n      entry: entry.trim()\n    });\n    if (!((_s3 = s) !== null && _s3 !== void 0 && _s3.user) || !entry.trim() || !u) {\n      console.error('‚ùå Guard rails failed - missing required data');\n      return;\n    }\n    console.log('üöÄ Starting submission process...');\n    setProcessingMessage(`‚è≥ ${toneName(forcedTone)} is thinking...`);\n    setIsProcessing(true);\n    const debug_marker = Math.random().toString(36).substring(2, 8);\n    const userId = s.user.id;\n    const backendUrl = process.env.REACT_APP_BACKEND_URL;\n    console.log('üì° API details:', {\n      backendUrl,\n      userId,\n      debug_marker,\n      entryLength: entry.length,\n      allEnvVars: {\n        REACT_APP_BACKEND_URL: process.env.REACT_APP_BACKEND_URL,\n        REACT_APP_SUPABASE_URL: process.env.REACT_APP_SUPABASE_URL,\n        NODE_ENV: process.env.NODE_ENV\n      }\n    });\n    try {\n      console.log('üì§ Making fetch request...');\n      const res = await fetch(`${backendUrl}/journal-entry`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          entry_text: entry,\n          tone_mode: forcedTone,\n          username: u,\n          user_id: userId,\n          debug_marker\n        })\n      });\n      console.log('üì• Response received:', {\n        status: res.status,\n        statusText: res.statusText,\n        ok: res.ok\n      });\n      if (!res.ok) {\n        console.error('‚ùå Response not OK:', res.status, res.statusText);\n        const errorText = await res.text();\n        console.error('‚ùå Error response body:', errorText);\n        return;\n      }\n      const data = await res.json();\n      console.log('‚úÖ Response data:', data);\n      const responseText = data.response || 'No response received.';\n      console.log('‚úÖ Submitting journal for user:', u);\n    } catch (err) {\n      console.error('‚ùå Submit failed with error:', err);\n      console.error('‚ùå Error details:', {\n        message: err.message,\n        stack: err.stack,\n        name: err.name\n      });\n    } finally {\n      setEntry('');\n      setParsedTags([]);\n      setSeverityLevel('');\n      setIsProcessing(false);\n      setTimeout(fetchHistory, 300);\n      setRefreshTrigger(prev => prev + 1);\n      // Collapse input on mobile after successful submission\n      if (window.innerWidth <= 768) {\n        setInputExpanded(false);\n      }\n    }\n  };\n\n  // üîΩ Function 5b: Generate Pattern Insight\n  const [processingMessage, setProcessingMessage] = useState(\"\");\n  const handlePatternInsight = async () => {\n    setProcessingMessage(`‚è≥ ${toneName(forcedTone)} is thinking...`);\n    setIsProcessing(true);\n    try {\n      var _userData$user;\n      const {\n        data: userData\n      } = await supabase.auth.getUser();\n      const userId = (_userData$user = userData.user) === null || _userData$user === void 0 ? void 0 : _userData$user.id;\n      const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/generate-pattern-insight`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          user_id: userId,\n          tone_mode: forcedTone // ‚úÖ pass selected voice\n        })\n      });\n      const data = await response.json();\n      if (response.ok) {\n        console.log('‚úÖ Insight:', data.insight);\n        setRefreshTrigger(prev => prev + 1); // üîÅ trigger timeline refresh\n      } else {\n        console.error('‚ùå Insight error:', data.error);\n      }\n    } catch (err) {\n      console.error('‚ùå Insight fetch failed:', err);\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  // üîΩ Function 6: Fetch Past Journals\n  const fetchHistory = async () => {\n    const user = session === null || session === void 0 ? void 0 : session.user;\n    if (!user) return;\n    const {\n      data,\n      error\n    } = await supabase.from('journals').select('id, entry_text, response_text, primary_theme, secondary_theme, tone_mode, timestamp, debug_marker').eq('user_id', user.id).order('timestamp', {\n      ascending: false\n    });\n    if (error) {\n      console.error(\"‚ùå Error fetching history:\", error.message);\n      return;\n    }\n\n    // üîΩ Function 6a: Filter Out No Respose, No debug markers \n\n    const showAll = true; // <== True all entries, False filtered \n    const filtered = showAll ? data || [] : (data || []).filter(entry => {\n      var _entry$response_text, _entry$debug_marker;\n      return ((_entry$response_text = entry.response_text) === null || _entry$response_text === void 0 ? void 0 : _entry$response_text.trim().toLowerCase()) !== 'no response received.' && ((_entry$debug_marker = entry.debug_marker) === null || _entry$debug_marker === void 0 ? void 0 : _entry$debug_marker.trim()) !== '';\n    });\n    // console.log(\"üìú Filtered journal history:\", filtered);  // <== Enable if False \n    setHistory(filtered);\n  };\n  useEffect(() => {\n    if (session) fetchHistory();\n  }, [session]);\n\n  // üîΩ UI State Routing\n  if (!session && !showLogin) {\n    return /*#__PURE__*/_jsxDEV(LandingPage, {\n      onStart: () => setShowLogin(true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 12\n    }, this);\n  }\n  if (!session) {\n    return /*#__PURE__*/_jsxDEV(LoginPage, {\n      onAuthSuccess: (session, username) => {\n        setSession(session);\n        setUsername(username);\n        UsernameStore.set(username); // <--persist\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 7\n    }, this);\n  }\n\n  // üîΩ Function 7: Generate Handoff Summaries  \n\n  // üîΩ Tone Display Utility\n  const displayTone = mode => {\n    const t = mode === null || mode === void 0 ? void 0 : mode.trim().toLowerCase();\n    return t === 'frank' ? 'üî¥ Frank Friend' : 'üü¢ Marcus Aurelius';\n  };\n  const getToneStyle = mode => {\n    const tone = mode === null || mode === void 0 ? void 0 : mode.trim().toLowerCase();\n    switch (tone) {\n      case 'frank':\n      case 'frank friend':\n        return {\n          backgroundColor: '#fff1f1',\n          borderColor: '#cc0000',\n          label: 'üî¥ Tony'\n        };\n      case 'marcus':\n      case 'marcus aurelius':\n        return {\n          backgroundColor: '#f0fdf4',\n          borderColor: '#2e7d32',\n          label: 'üü¢ Marcus Aurelius'\n        };\n      case 'therapist':\n        return {\n          backgroundColor: '#fef6ff',\n          borderColor: '#b755e5',\n          label: 'üü£ Clara'\n        };\n      case 'movies':\n        return {\n          backgroundColor: '#fdfaf6',\n          borderColor: '#ff8c00',\n          label: 'üé¨ Movie Metaphors Man'\n        };\n      case 'verena':\n        return {\n          backgroundColor: '#ffeaf0',\n          borderColor: '#ec407a',\n          label: 'üå∏ Verena'\n        };\n      default:\n        return {\n          backgroundColor: '#eeeeee',\n          borderColor: '#999999',\n          label: '‚ùì Unknown'\n        };\n    }\n  };\n\n  // Centralize tooltip copy in one place\n  const TOOLTIP_TEXT = {\n    pattern: \"Generates a unified insight based on your recent themes, topics, and emotional loops.\",\n    therapist: \"A handoff-style recap of emotional themes, loops, and potential focus areas for therapy.\",\n    mood: \"Visualizes your emotional trends over time. Coming soon.\"\n  };\n\n  // üîΩ UI Rendering\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [showWelcome && welcomeStep === 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        width: '100%',\n        height: '100%',\n        backgroundColor: 'rgba(255,255,255,0.96)',\n        zIndex: 1000,\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center',\n        flexDirection: 'column',\n        padding: '2rem',\n        textAlign: 'center',\n        fontFamily: 'sans-serif',\n        overflowY: 'auto'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          maxWidth: '700px',\n          width: '90%'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          style: {\n            marginBottom: '1rem',\n            fontSize: '1.6rem'\n          },\n          children: \"\\u2728 Choose Your Companion\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 382,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          style: {\n            textAlign: 'left',\n            fontSize: '1rem',\n            marginBottom: '2rem'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"li\", {\n            style: {\n              marginBottom: '1rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"\\uD83D\\uDCAA\\uD83C\\uDF77 Tony\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 385,\n              columnNumber: 15\n            }, this), \" \\u2013 A frank, no-bullshit friend who\\u2019s always honest and supportive, helping you cut through the crap and break free from the loops that keep you stuck.\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 384,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            style: {\n              marginBottom: '1rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"\\uD83E\\uDDD8 Marcus Aurelius\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 388,\n              columnNumber: 15\n            }, this), \" \\u2013 Speaks like the Stoic philosopher himself\\u2014calm, sparse, and deeply rooted in principle. If inspired he may quote from his own journal, \", /*#__PURE__*/_jsxDEV(\"i\", {\n              children: \"Meditations\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 388,\n              columnNumber: 178\n            }, this), \".\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 387,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            style: {\n              marginBottom: '1rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"\\uD83E\\uDE7A Clara\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 391,\n              columnNumber: 15\n            }, this), \" \\u2013 A warm, grounded therapist who sees the pattern beneath the panic.\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 390,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            style: {\n              marginBottom: '1rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"\\uD83C\\uDFAC Movie Metaphor Man\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 394,\n              columnNumber: 15\n            }, this), \" \\u2013 Only thinks in movie metaphors\\u2014no matter what you say. Your problems are part of the hero's journey.\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 393,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            style: {\n              marginBottom: '1.5rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"\\uD83C\\uDF38 Verena\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 397,\n              columnNumber: 15\n            }, this), \" \\u2013 Verena is a clarity-driven career coach who helps you stop spinning your wheels and start building something real.\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 396,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 383,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setShowWelcome(false),\n          style: {\n            padding: '0.8rem 1.5rem',\n            fontSize: '1rem',\n            borderRadius: '6px',\n            backgroundColor: '#374151',\n            color: '#fff',\n            border: 'none',\n            cursor: 'pointer'\n          },\n          children: \"Let\\u2019s begin \\u2192\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 401,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 381,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 362,\n      columnNumber: 7\n    }, this), !showWelcome && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-container background-option-1\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            style: {\n              marginBottom: '0.3rem',\n              fontSize: '1.8rem',\n              fontWeight: 600,\n              letterSpacing: '0.5px',\n              color: '#1a1a1a',\n              fontFamily: 'Georgia, serif',\n              textShadow: '0 1px 1px rgba(0,0,0,0.1)'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"mirror-emoji\",\n              role: \"img\",\n              \"aria-label\": \"mirror\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 436,\n              columnNumber: 15\n            }, this), ' ', \"Cognitive Mirror\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 425,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'inline-block',\n              padding: '0.2rem 0.6rem',\n              fontSize: '0.75rem',\n              color: '#555',\n              backgroundColor: '#f5f5f5',\n              border: '1px solid #ddd',\n              borderRadius: '6px',\n              fontStyle: 'italic'\n            },\n            children: \"\\uD83D\\uDEA7 Rough Beta: Responses can take up to a minute. Thanks for your patience.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 441,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 424,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            gap: '0.75rem'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            title: (session === null || session === void 0 ? void 0 : (_session$user = session.user) === null || _session$user === void 0 ? void 0 : _session$user.id) || '',\n            style: {\n              fontSize: '.85rem',\n              color: '#374151',\n              background: '#eef2ff',\n              border: '1px solid #c7d2fe',\n              padding: '4px 8px',\n              borderRadius: '6px',\n              lineHeight: 1.2,\n              whiteSpace: 'nowrap'\n            },\n            children: [\"Signed in as \", /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: username || '‚Äî'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 472,\n              columnNumber: 26\n            }, this), session !== null && session !== void 0 && (_session$user2 = session.user) !== null && _session$user2 !== void 0 && _session$user2.id ? /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                color: '#6b7280',\n                marginLeft: 6\n              },\n              children: [\"(\", session.user.id.slice(0, 8), \")\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 474,\n              columnNumber: 15\n            }, this) : null]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 459,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: async () => {\n              await supabase.auth.signOut();\n              setSession(null);\n            },\n            style: {\n              padding: '6px 10px',\n              borderRadius: 6,\n              border: '1px solid #d1d5db',\n              background: '#fff',\n              cursor: 'pointer'\n            },\n            children: \"Log Out\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 480,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 458,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 423,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `reflection-input-container ${inputExpanded ? 'expanded' : 'collapsed'}`,\n        onClick: () => {\n          console.log('üîç Input container clicked - inputExpanded:', inputExpanded, 'window width:', window.innerWidth);\n          if (!inputExpanded && window.innerWidth <= 768) {\n            console.log('‚úÖ Expanding input on mobile');\n            setInputExpanded(true);\n          }\n        },\n        onTouchStart: e => {\n          console.log('üëÜ Touch start - inputExpanded:', inputExpanded, 'window width:', window.innerWidth);\n          if (!inputExpanded && window.innerWidth <= 768) {\n            console.log('‚úÖ Expanding input on mobile touch');\n            e.preventDefault();\n            setInputExpanded(true);\n          }\n        },\n        style: {\n          touchAction: 'manipulation'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          className: \"reflection-textarea\",\n          rows: \"3\",\n          value: entry,\n          onChange: e => {\n            console.log('üìù Textarea onChange:', e.target.value);\n            setEntry(e.target.value);\n          },\n          onFocus: () => console.log('üéØ Textarea focused'),\n          onBlur: () => console.log('üëã Textarea blurred'),\n          onKeyDown: e => {\n            if (e.key === 'Enter' && !e.shiftKey) {\n              e.preventDefault();\n              if (entry.trim() && !isProcessing) {\n                handleSubmit();\n              }\n            }\n            if (e.key === 'Escape' && window.innerWidth <= 768) {\n              setInputExpanded(false);\n            }\n          },\n          placeholder: placeholderPrompt\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 518,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cm-toolbar\",\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            flexWrap: 'wrap',\n            gap: '8px 12px',\n            padding: '6px 10px',\n            background: '#f2f2f2',\n            border: '1px solid #e6e6e6',\n            borderRadius: '6px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cm-actions\",\n            style: {\n              display: 'flex',\n              alignItems: 'center',\n              gap: 8,\n              flexWrap: 'wrap',\n              position: 'relative'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"cm-btn\",\n              onClick: handleSubmit,\n              id: \"reflect-btn\",\n              \"aria-label\": \"Reflect\",\n              type: \"button\",\n              disabled: isProcessing || !entry.trim(),\n              children: \"\\uD83E\\uDDE0 Reflect\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 567,\n              columnNumber: 15\n            }, this), window.innerWidth <= 768 && inputExpanded && /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"cm-btn\",\n              onClick: () => setInputExpanded(false),\n              \"aria-label\": \"Close\",\n              type: \"button\",\n              children: \"\\u2715 Close\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 579,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"cm-btn\",\n              onClick: handlePatternInsight,\n              onMouseEnter: () => setTooltipVisible('pattern'),\n              onMouseLeave: () => setTooltipVisible(null),\n              children: \"\\uD83E\\uDDED See Pattern Insight\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 588,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"cm-btn\",\n              onClick: () => setShowSummary(true),\n              onMouseEnter: () => setTooltipVisible('therapist'),\n              onMouseLeave: () => setTooltipVisible(null),\n              children: \"\\uD83E\\uDE7A Therapist Summary\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 597,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"cm-btn\",\n              onClick: handleOpenMoodTracker /* your existing handler */,\n              onMouseEnter: () => setTooltipVisible('mood'),\n              onMouseLeave: () => setTooltipVisible(null),\n              children: \"\\uD83D\\uDCCA Mood Tracker\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 606,\n              columnNumber: 15\n            }, this), tooltipVisible && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                position: 'absolute',\n                top: '-2.4rem',\n                left: '50%',\n                transform: 'translateX(-50%)',\n                background: '#333',\n                color: '#fff',\n                padding: '0.4rem 0.6rem',\n                borderRadius: 6,\n                fontSize: '0.75rem',\n                whiteSpace: 'nowrap',\n                zIndex: 20,\n                pointerEvents: 'none'\n              },\n              children: [tooltipVisible === 'pattern' && 'Generates a unified insight based on your recent themes, topics, and emotional loops.', tooltipVisible === 'therapist' && 'A handoff-style recap of emotional themes, loops, and potential focus areas for therapy.', tooltipVisible === 'mood' && 'Visualizes your emotional trends over time.']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 617,\n              columnNumber: 17\n            }, this), isListening && /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"\\uD83C\\uDFA7 Listening\\u2026\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 641,\n              columnNumber: 31\n            }, this), isProcessing && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"processing-message\",\n              children: [\"\\u23F3 \", toneName(forcedTone), \" is thinking\", /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"dots\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 644,\n                columnNumber: 55\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 643,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 556,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cm-voice\",\n            style: {\n              display: 'flex',\n              alignItems: 'center',\n              gap: '8px 10px',\n              flexWrap: 'wrap',\n              borderLeft: '1px solid #e6e6e6',\n              paddingLeft: 12\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              style: {\n                marginRight: '0.35rem'\n              },\n              children: \"\\uD83D\\uDDE3\\uFE0F Voice:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 661,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              value: forcedTone,\n              onChange: handleToneChange,\n              \"aria-label\": \"Select voice\",\n              style: {\n                minWidth: 120,\n                maxWidth: 160,\n                padding: '6px 8px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"therapist\",\n                children: \"Clara\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 668,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"marcus\",\n                children: \"Marcus\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 669,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"frank\",\n                children: \"Tony\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 670,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"movies\",\n                children: \"Movies\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 671,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"verena\",\n                children: \"Verena\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 672,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 662,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cm-tone-desc\",\n              \"aria-live\": \"polite\",\n              children: toneDescription\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 674,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 650,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 542,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 499,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          flex: 1,\n          overflowY: 'auto',\n          paddingBottom: window.innerWidth <= 768 ? '0.5rem' : '2rem',\n          WebkitOverflowScrolling: 'touch',\n          // Smooth scrolling on iOS\n          // Remove smooth scroll to prevent zoom interference\n          scrollBehavior: 'auto',\n          touchAction: 'pan-x pan-y pinch-zoom' // Allow pinch-zoom\n        },\n        children: /*#__PURE__*/_jsxDEV(JournalTimeline, {\n          userId: session === null || session === void 0 ? void 0 : (_session$user3 = session.user) === null || _session$user3 === void 0 ? void 0 : _session$user3.id,\n          refreshTrigger: refreshTrigger,\n          styleVariant: styleVariant\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 696,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 687,\n        columnNumber: 9\n      }, this), showSummary && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: '1rem'\n        },\n        children: /*#__PURE__*/_jsxDEV(SummaryViewer, {\n          history: history,\n          onClose: () => setShowSummary(false)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 702,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 701,\n        columnNumber: 11\n      }, this), showMoodTracker && /*#__PURE__*/_jsxDEV(MoodModal, {\n        userId: session === null || session === void 0 ? void 0 : (_session$user4 = session.user) === null || _session$user4 === void 0 ? void 0 : _session$user4.id,\n        onClose: handleCloseMoodTracker\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 707,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 421,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n_s4(App, \"RVjncqsQbflSDKagqSM9wungprg=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useEffect","useState","SummaryViewer","supabase","UsernameStore","getBootSession","subscribeAuth","LandingPage","LoginPage","JournalTimeline","MoodModal","jsxDEV","_jsxDEV","Fragment","_Fragment","App","_s4","_session$user","_session$user2","_session$user3","_session$user4","toneDescriptions","therapist","marcus","frank","movies","verena","forcedTone","setForcedTone","toneDescription","setToneDescription","handleToneChange","e","val","target","value","toneName","t","showLogin","setShowLogin","session","setSession","entry","setEntry","history","setHistory","tooltip","setTooltip","latestEntryId","setLatestEntryId","showSummary","setShowSummary","loadingSummary","setLoadingSummary","summary","setSummary","parsedTags","setParsedTags","severityLevel","setSeverityLevel","isProcessing","setIsProcessing","recognition","setRecognition","inputExpanded","setInputExpanded","debugInfo","setDebugInfo","isListening","setIsListening","prompts","showGroupedView","setShowGroupedView","placeholderPrompt","setPlaceholderPrompt","Math","floor","random","length","refreshTrigger","setRefreshTrigger","transcriptBuffer","tooltipVisible","setTooltipVisible","styleVariant","setStyleVariant","showWelcome","setShowWelcome","welcomeStep","setWelcomeStep","username","setUsername","showMoodTracker","setShowMoodTracker","handleCloseMoodTracker","handleOpenMoodTracker","saved","get","console","log","process","env","REACT_APP_ENV","REACT_APP_BACKEND_URL","REACT_APP_SUPABASE_URL","hasTriggeredSummary","localStorage","getItem","setItem","fetch","then","res","text","stop","handleSubmit","_s","_s2","_s2$user","_s3","warn","window","innerWidth","trim","u","s","hasSession","user","hasEntry","hasUsername","sessionUser","id","error","setProcessingMessage","debug_marker","toString","substring","userId","backendUrl","entryLength","allEnvVars","NODE_ENV","method","headers","body","JSON","stringify","entry_text","tone_mode","user_id","status","statusText","ok","errorText","data","json","responseText","response","err","message","stack","name","setTimeout","fetchHistory","prev","processingMessage","handlePatternInsight","_userData$user","userData","auth","getUser","insight","from","select","eq","order","ascending","showAll","filtered","filter","_entry$response_text","_entry$debug_marker","response_text","toLowerCase","onStart","fileName","_jsxFileName","lineNumber","columnNumber","onAuthSuccess","set","displayTone","mode","getToneStyle","tone","backgroundColor","borderColor","label","TOOLTIP_TEXT","pattern","mood","children","style","position","top","left","width","height","zIndex","display","justifyContent","alignItems","flexDirection","padding","textAlign","fontFamily","overflowY","maxWidth","marginBottom","fontSize","onClick","borderRadius","color","border","cursor","className","fontWeight","letterSpacing","textShadow","role","fontStyle","gap","title","background","lineHeight","whiteSpace","marginLeft","slice","signOut","onTouchStart","preventDefault","touchAction","rows","onChange","onFocus","onBlur","onKeyDown","key","shiftKey","placeholder","flexWrap","type","disabled","onMouseEnter","onMouseLeave","transform","pointerEvents","borderLeft","paddingLeft","marginRight","minWidth","flex","paddingBottom","WebkitOverflowScrolling","scrollBehavior","marginTop","onClose","_c","$RefreshReg$"],"sources":["/Users/mac/Projects/cognitive-mirror-frontend-dev/src/App.js"],"sourcesContent":["// üîº Imports and Setup      \nimport React, { useEffect, useState } from 'react'; \nimport SummaryViewer from './SummaryViewer'; \nimport { supabase, UsernameStore, getBootSession, subscribeAuth } from './supabaseClient';\nimport './App.css';\n// import DemoSofia from './pages/DemoSofia';\nimport LandingPage from './LandingPage';\nimport LoginPage from './LoginPage';\nimport JournalTimeline from './components/JournalTimeline';\nimport MoodModal from './components/MoodModal'; \n\nconst App = () => {\n\n  // --- Tone descriptions map ---\n  const toneDescriptions = {\n    therapist: \"ü©∫ Clara ‚Äì A warm, grounded therapist who sees the pattern beneath the panic.\",\n    marcus: \"üßò Marcus ‚Äì Speaks like the Stoic philosopher himself. Will quote Meditations.\",\n    frank: \"üí™üç∑ Tony ‚Äì A frank, no-bullshit friend who tells you what you need to hear.\",\n    movies: \"üé¨ Movies ‚Äì A movie buff who only speaks through movie metaphors.\",\n    verena: \"üå∏ Verena ‚Äì A clarity-driven life coach unphased by self-pity.\"\n  };\n\n  // Default to Clara\n  const [forcedTone, setForcedTone] = useState(\"therapist\");\n  // Keep a visible description bound to the current selection\n  const [toneDescription, setToneDescription] = useState(toneDescriptions[\"therapist\"]);\n\n  const handleToneChange = (e) => {\n    const val = e.target.value;\n    setForcedTone(val);\n    setToneDescription(toneDescriptions[val] || \"\");\n  };\n\n  const toneName = (t) =>\n  ({ therapist: 'Clara', marcus: 'Marcus', frank: 'Tony', movies: 'Movies', verena: 'Verena' }[t] || 'Mirror');\n\n  // üîΩ Existing states (no change to their order beyond moving forcedTone here)\n  const [showLogin, setShowLogin] = useState(false);\n  const [session, setSession] = useState(null);\n  const [entry, setEntry] = useState('');\n  const [history, setHistory] = useState([]);\n  const [tooltip, setTooltip] = useState(\"ü©∫ Clara ‚Äì A warm, grounded therapist who sees the pattern beneath the panic.\");\n  const [latestEntryId, setLatestEntryId] = useState(null);\n  const [showSummary, setShowSummary] = useState(false);\n  const [loadingSummary, setLoadingSummary] = useState(false);\n  const [summary, setSummary] = useState('');\n  const [parsedTags, setParsedTags] = useState([]);\n  const [severityLevel, setSeverityLevel] = useState('');\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [recognition, setRecognition] = useState(null);\n  const [inputExpanded, setInputExpanded] = useState(false);\n  const [debugInfo, setDebugInfo] = useState('');\n  const [isListening, setIsListening] = useState(false);\n  const prompts = [\"What‚Äôs shaking sugar?\"];\n  const [showGroupedView, setShowGroupedView] = useState(false);\n  const [placeholderPrompt, setPlaceholderPrompt] = useState(() =>\n    prompts[Math.floor(Math.random() * prompts.length)] \n  );\n  const [refreshTrigger, setRefreshTrigger] = useState(0);\n  let transcriptBuffer = '';\n  const [tooltipVisible, setTooltipVisible] = useState(null); // 'pattern' | 'therapist' | 'mood' | null\n  const [styleVariant, setStyleVariant] = useState(\"D\")\n  const [showWelcome, setShowWelcome] = useState(false);\n  const [welcomeStep, setWelcomeStep] =useState(1);\n  const [username, setUsername] = useState('');\n  const [showMoodTracker, setShowMoodTracker] = useState(false);\n  const handleCloseMoodTracker = () => setShowMoodTracker(false);\n  const handleOpenMoodTracker = () => setShowMoodTracker(true);\n\n  // üîΩ Function 1: Load Saved Username (rehydrate)\n  useEffect(() => {\n    const saved = UsernameStore.get();\n    if (saved) setUsername(saved);\n  }, []);\n\n    // Log environment on startup\n  useEffect(() => {\n    console.log(`üöÄ Running in ${process.env.REACT_APP_ENV || 'unknown'} mode`);\n    console.log(`üõ∞Ô∏è Backend: ${process.env.REACT_APP_BACKEND_URL || 'unset'}`);\n    console.log(`üóÑÔ∏è Supabase: ${process.env.REACT_APP_SUPABASE_URL || 'unset'}`);\n  }, []);\n  \n  // üîΩ Function 3: Show Summary Trigger\n  useEffect(() => {\n    const hasTriggeredSummary = localStorage.getItem('hasTriggeredSummary');\n    if (!hasTriggeredSummary && history.length >= 5) {\n      setShowSummary(true);\n      localStorage.setItem('hasTriggeredSummary', 'true');\n    }\n  }, [history]);\n\n   // üîΩ Function 3a: Build Current Commit Tag \n  useEffect(() => {\n    fetch('/build-version.txt')\n      .then(res => res.text())\n      .then(text => {\n         console.log(\"üõ†Ô∏è App.js version:\", text);\n         // console.log(`üß± Frontend build version: ${text}`);\n      });\n  }, []);\n\n  // üîΩ Function 4: Auth Setup (boot + subscribe once)\n    useEffect(() => {\n      let stop = () => {};\n      (async () => {\n        setSession(await getBootSession());\n        stop = subscribeAuth(setSession);\n      })();\n      return () => stop();\n    }, []);\n\n // üîΩ Function 5: Submit New Journal Entry (username/session‚Äìsafe)\n  const handleSubmit = async () => {\n    console.warn(\"üß™ handleSubmit called from device width:\", window.innerWidth);\n    console.log(\"üìù Entry content:\", entry.trim());\n\n    // Always read a stable username\n    const u = (username || UsernameStore.get() || '').trim();\n\n    // Make sure we have a session\n    let s = session;\n    if (!s) {\n      s = await getBootSession();\n      if (s) setSession(s);\n    }\n\n    // Guard rails: must have session + entry + username\n    console.log('üîç Guard rails check:', { \n      hasSession: !!s?.user, \n      hasEntry: !!entry.trim(), \n      hasUsername: !!u,\n      sessionUser: s?.user?.id,\n      username: u,\n      entry: entry.trim()\n    });\n    \n    if (!s?.user || !entry.trim() || !u) {\n      console.error('‚ùå Guard rails failed - missing required data');\n      return;\n    }\n\n    console.log('üöÄ Starting submission process...');\n    setProcessingMessage(`‚è≥ ${toneName(forcedTone)} is thinking...`);\n    setIsProcessing(true);\n\n    const debug_marker = Math.random().toString(36).substring(2, 8);\n    const userId = s.user.id;\n    const backendUrl = process.env.REACT_APP_BACKEND_URL;\n    \n    console.log('üì° API details:', { \n      backendUrl, \n      userId, \n      debug_marker,\n      entryLength: entry.length,\n      allEnvVars: {\n        REACT_APP_BACKEND_URL: process.env.REACT_APP_BACKEND_URL,\n        REACT_APP_SUPABASE_URL: process.env.REACT_APP_SUPABASE_URL,\n        NODE_ENV: process.env.NODE_ENV\n      }\n    });\n\n    try {\n      console.log('üì§ Making fetch request...');\n      const res = await fetch(`${backendUrl}/journal-entry`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          entry_text: entry,\n          tone_mode: forcedTone,\n          username: u,\n          user_id: userId,\n          debug_marker,\n        }),\n      });\n\n      console.log('üì• Response received:', { \n        status: res.status, \n        statusText: res.statusText,\n        ok: res.ok \n      });\n\n      if (!res.ok) {\n        console.error('‚ùå Response not OK:', res.status, res.statusText);\n        const errorText = await res.text();\n        console.error('‚ùå Error response body:', errorText);\n        return;\n      }\n\n      const data = await res.json();\n      console.log('‚úÖ Response data:', data);\n      const responseText = data.response || 'No response received.';\n      console.log('‚úÖ Submitting journal for user:', u);\n    } catch (err) {\n      console.error('‚ùå Submit failed with error:', err);\n      console.error('‚ùå Error details:', {\n        message: err.message,\n        stack: err.stack,\n        name: err.name\n      });\n    } finally {\n      setEntry('');\n      setParsedTags([]);\n      setSeverityLevel('');\n      setIsProcessing(false);\n      setTimeout(fetchHistory, 300);\n      setRefreshTrigger(prev => prev + 1);\n      // Collapse input on mobile after successful submission\n      if (window.innerWidth <= 768) {\n        setInputExpanded(false);\n      }\n    }\n  };\n\n  // üîΩ Function 5b: Generate Pattern Insight\n  const [processingMessage, setProcessingMessage] = useState(\"\");\n  \n  const handlePatternInsight = async () => {\n    setProcessingMessage(`‚è≥ ${toneName(forcedTone)} is thinking...`);\n    setIsProcessing(true);\n  \n    try {\n      const { data: userData } = await supabase.auth.getUser();\n      const userId = userData.user?.id;\n      \n      const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/generate-pattern-insight`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          user_id: userId,\n          tone_mode: forcedTone // ‚úÖ pass selected voice\n        })\n      });\n  \n      const data = await response.json();\n  \n      if (response.ok) {\n        console.log('‚úÖ Insight:', data.insight);\n        setRefreshTrigger(prev => prev + 1); // üîÅ trigger timeline refresh\n      } else {\n        console.error('‚ùå Insight error:', data.error);\n      }\n    } catch (err) {\n      console.error('‚ùå Insight fetch failed:', err);\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n  \n   // üîΩ Function 6: Fetch Past Journals\n  const fetchHistory = async () => {\n    const user = session?.user;\n    if (!user) return;\n    const { data, error } = await supabase\n      .from('journals')\n      .select('id, entry_text, response_text, primary_theme, secondary_theme, tone_mode, timestamp, debug_marker')\n      .eq('user_id', user.id)\n      .order('timestamp', { ascending: false });\n      \n    if (error) {\n    console.error(\"‚ùå Error fetching history:\", error.message);\n    return;\n  }\n\n  // üîΩ Function 6a: Filter Out No Respose, No debug markers \n\n  const showAll = true; // <== True all entries, False filtered \n  const filtered = showAll\n    ? (data || [])\n    : (data || []).filter(entry =>\n    entry.response_text?.trim().toLowerCase() !== 'no response received.' &&\n    entry.debug_marker?.trim() !== ''\n  );\n  // console.log(\"üìú Filtered journal history:\", filtered);  // <== Enable if False \n  setHistory(filtered);\n};\n\n  useEffect(() => {\n    if (session) fetchHistory();\n  }, [session]);\n\n  // üîΩ UI State Routing\n  if (!session && !showLogin) {\n    return <LandingPage onStart={() => setShowLogin(true)} />;\n  }\n\n  if (!session) {\n    return (\n      <LoginPage\n        onAuthSuccess={(session, username) => {\n          setSession(session);\n          setUsername(username);\n          UsernameStore.set(username); // <--persist\n        }}\n      />\n    );\n  }\n\n// üîΩ Function 7: Generate Handoff Summaries  \n\n  // üîΩ Tone Display Utility\n  const displayTone = (mode) => {\n    const t = mode?.trim().toLowerCase();\n    return t === 'frank' ? 'üî¥ Frank Friend' : 'üü¢ Marcus Aurelius';\n  };\n\n  const getToneStyle = (mode) => {\n    const tone = mode?.trim().toLowerCase();\n    switch (tone) {\n      case 'frank':\n      case 'frank friend':\n        return {\n          backgroundColor: '#fff1f1',\n          borderColor: '#cc0000',\n          label: 'üî¥ Tony',\n        };\n      case 'marcus':\n      case 'marcus aurelius':\n        return {\n          backgroundColor: '#f0fdf4',\n          borderColor: '#2e7d32',\n          label: 'üü¢ Marcus Aurelius',\n        };\n      case 'therapist':\n        return {\n          backgroundColor: '#fef6ff',\n          borderColor: '#b755e5',\n          label: 'üü£ Clara',\n        };\n      case 'movies':\n        return {\n          backgroundColor: '#fdfaf6',\n          borderColor: '#ff8c00',\n          label: 'üé¨ Movie Metaphors Man',\n        };\n      case 'verena':\n          return {\n            backgroundColor: '#ffeaf0',\n            borderColor: '#ec407a',\n            label: 'üå∏ Verena',\n        };  \n      default:\n        return {\n          backgroundColor: '#eeeeee',\n          borderColor: '#999999',\n          label: '‚ùì Unknown',\n        };\n    }\n  };\n\n    // Centralize tooltip copy in one place\n    const TOOLTIP_TEXT = {\n      pattern: \"Generates a unified insight based on your recent themes, topics, and emotional loops.\",\n      therapist: \"A handoff-style recap of emotional themes, loops, and potential focus areas for therapy.\",\n      mood: \"Visualizes your emotional trends over time. Coming soon.\"\n    };\n\n// üîΩ UI Rendering\nreturn (\n  <>\n    {/* Step 1: Voice Introduction + Begin */}\n    {showWelcome && welcomeStep === 1 && (\n      <div\n        style={{\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          width: '100%',\n          height: '100%',\n          backgroundColor: 'rgba(255,255,255,0.96)',\n          zIndex: 1000,\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          flexDirection: 'column',\n          padding: '2rem',\n          textAlign: 'center',\n          fontFamily: 'sans-serif',\n          overflowY: 'auto'\n        }}\n      >\n        <div style={{ maxWidth: '700px', width: '90%' }}>\n          <h2 style={{ marginBottom: '1rem', fontSize: '1.6rem' }}>‚ú® Choose Your Companion</h2>\n          <ul style={{ textAlign: 'left', fontSize: '1rem', marginBottom: '2rem' }}>\n            <li style={{ marginBottom: '1rem' }}>\n              <b>üí™üç∑ Tony</b> ‚Äì A frank, no-bullshit friend who‚Äôs always honest and supportive, helping you cut through the crap and break free from the loops that keep you stuck.\n            </li>\n            <li style={{ marginBottom: '1rem' }}>\n              <b>üßò Marcus Aurelius</b> ‚Äì Speaks like the Stoic philosopher himself‚Äîcalm, sparse, and deeply rooted in principle. If inspired he may quote from his own journal, <i>Meditations</i>.\n            </li>\n            <li style={{ marginBottom: '1rem' }}>\n              <b>ü©∫ Clara</b> ‚Äì A warm, grounded therapist who sees the pattern beneath the panic.\n            </li>\n            <li style={{ marginBottom: '1rem' }}>\n              <b>üé¨ Movie Metaphor Man</b> ‚Äì Only thinks in movie metaphors‚Äîno matter what you say. Your problems are part of the hero's journey.\n            </li>\n            <li style={{ marginBottom: '1.5rem' }}>\n              <b>üå∏ Verena</b> ‚Äì Verena is a clarity-driven career coach who helps you stop spinning your wheels and start building something real.\n            </li>\n          </ul>\n\n          <button\n            onClick={() => setShowWelcome(false)}\n            style={{\n              padding: '0.8rem 1.5rem',\n              fontSize: '1rem',\n              borderRadius: '6px',\n              backgroundColor: '#374151',\n              color: '#fff',\n              border: 'none',\n              cursor: 'pointer'\n            }}\n          >\n            Let‚Äôs begin ‚Üí\n          </button>\n        </div>\n      </div>\n    )}\n\n    {/* MAIN APP INTERFACE ‚Äî Only render when welcome is dismissed */}\n    {!showWelcome && (\n      <div className=\"chat-container background-option-1\">\n        {/* Header with Logout */}\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n          <div>\n            <h1\n              style={{\n                marginBottom: '0.3rem',\n                fontSize: '1.8rem',\n                fontWeight: 600,\n                letterSpacing: '0.5px',\n                color: '#1a1a1a',\n                fontFamily: 'Georgia, serif',\n                textShadow: '0 1px 1px rgba(0,0,0,0.1)'\n              }}\n            >\n              <span className=\"mirror-emoji\" role=\"img\" aria-label=\"mirror\">\n              </span>{' '}\n              Cognitive Mirror\n            </h1>\n\n            <div\n              style={{\n                display: 'inline-block',\n                padding: '0.2rem 0.6rem',\n                fontSize: '0.75rem',\n                color: '#555',\n                backgroundColor: '#f5f5f5',\n                border: '1px solid #ddd',\n                borderRadius: '6px',\n                fontStyle: 'italic'\n              }}\n            >\n               üöß Rough Beta: Responses can take up to a minute. Thanks for your patience.\n            </div>\n          </div>\n  \n        {/* Username and Logout Button Placement Top Right */}\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem' }}>\n          <div\n            title={session?.user?.id || ''}\n            style={{\n              fontSize: '.85rem',\n              color: '#374151',\n              background: '#eef2ff',\n              border: '1px solid #c7d2fe',\n              padding: '4px 8px',\n              borderRadius: '6px',\n              lineHeight: 1.2,\n              whiteSpace: 'nowrap'\n            }}\n          >\n            Signed in as <strong>{username || '‚Äî'}</strong>\n            {session?.user?.id ? (\n              <span style={{ color: '#6b7280', marginLeft: 6 }}>\n                ({(session.user.id).slice(0, 8)})\n              </span>\n            ) : null}\n          </div>\n\n          <button\n            onClick={async () => {\n              await supabase.auth.signOut();\n              setSession(null);\n            }}\n            style={{\n              padding: '6px 10px',\n              borderRadius: 6,\n              border: '1px solid #d1d5db',\n              background: '#fff',\n              cursor: 'pointer'\n            }}\n          >\n            Log Out\n          </button>\n        </div>\n        </div>\n\n        {/* Sticky Input Bar (fixed) */}\n        <div\n          className={`reflection-input-container ${inputExpanded ? 'expanded' : 'collapsed'}`}\n          onClick={() => {\n            console.log('üîç Input container clicked - inputExpanded:', inputExpanded, 'window width:', window.innerWidth);\n            if (!inputExpanded && window.innerWidth <= 768) {\n              console.log('‚úÖ Expanding input on mobile');\n              setInputExpanded(true);\n            }\n          }}\n          onTouchStart={(e) => {\n            console.log('üëÜ Touch start - inputExpanded:', inputExpanded, 'window width:', window.innerWidth);\n            if (!inputExpanded && window.innerWidth <= 768) {\n              console.log('‚úÖ Expanding input on mobile touch');\n              e.preventDefault();\n              setInputExpanded(true);\n            }\n          }}\n          style={{ touchAction: 'manipulation' }}\n        >\n          <textarea\n          className=\"reflection-textarea\"\n          rows=\"3\"\n          value={entry}\n          onChange={(e) => {\n            console.log('üìù Textarea onChange:', e.target.value);\n            setEntry(e.target.value);\n          }}\n          onFocus={() => console.log('üéØ Textarea focused')}\n          onBlur={() => console.log('üëã Textarea blurred')}\n          onKeyDown={(e) => {\n            if (e.key === 'Enter' && !e.shiftKey) {\n              e.preventDefault();\n              if (entry.trim() && !isProcessing) {\n                handleSubmit();\n              }\n            }\n            if (e.key === 'Escape' && window.innerWidth <= 768) {\n              setInputExpanded(false);\n            }\n          }}\n          placeholder={placeholderPrompt}\n        />\n          {/* Toolbar row: all action buttons on one line */}\n          <div\n            className=\"cm-toolbar\"\n            style={{\n              display: 'flex',\n              alignItems: 'center',\n              flexWrap: 'wrap',\n              gap: '8px 12px',\n              padding: '6px 10px',\n              background: '#f2f2f2',\n              border: '1px solid #e6e6e6',\n              borderRadius: '6px'\n            }}\n          >\n            {/* Action buttons (one row) */}\n            <div\n              className=\"cm-actions\"\n              style={{ display: 'flex', alignItems: 'center', gap: 8, flexWrap: 'wrap', position: 'relative' }}\n            >\n              {/* <button className=\"cm-btn\" onClick={startListening} disabled={isListening}>\n                üéôÔ∏è Start\n              </button>\n              <button className=\"cm-btn\" onClick={stopListening} disabled={!isListening}>\n                üõë Stop\n          </button> */}\n          \n              <button \n                  className=\"cm-btn\" \n                  onClick={handleSubmit}\n                  id=\"reflect-btn\"\n                  aria-label=\"Reflect\"\n                  type=\"button\" \n                  disabled={isProcessing || !entry.trim()}>\n                üß† Reflect\n              </button>\n\n              {/* Mobile close button when expanded */}\n              {window.innerWidth <= 768 && inputExpanded && (\n                <button \n                  className=\"cm-btn\" \n                  onClick={() => setInputExpanded(false)}\n                  aria-label=\"Close\"\n                  type=\"button\">\n                  ‚úï Close\n                </button>\n              )}\n\n              <button\n                className=\"cm-btn\"\n                onClick={handlePatternInsight}\n                onMouseEnter={() => setTooltipVisible('pattern')}\n                onMouseLeave={() => setTooltipVisible(null)}\n              >\n                üß≠ See Pattern Insight\n              </button>\n\n              <button\n                className=\"cm-btn\"\n                onClick={() => setShowSummary(true)}\n                onMouseEnter={() => setTooltipVisible('therapist')}\n                onMouseLeave={() => setTooltipVisible(null)}\n              >\n                ü©∫ Therapist Summary\n              </button>\n\n              <button\n                className=\"cm-btn\"\n                onClick={handleOpenMoodTracker /* your existing handler */}\n                onMouseEnter={() => setTooltipVisible('mood')}\n                onMouseLeave={() => setTooltipVisible(null)}\n              >\n                üìä Mood Tracker\n              </button>\n\n              {/* Shared tooltip renderer for the three buttons */}\n              {tooltipVisible && (\n                <div\n                  style={{\n                    position: 'absolute',\n                    top: '-2.4rem',\n                    left: '50%',\n                    transform: 'translateX(-50%)',\n                    background: '#333',\n                    color: '#fff',\n                    padding: '0.4rem 0.6rem',\n                    borderRadius: 6,\n                    fontSize: '0.75rem',\n                    whiteSpace: 'nowrap',\n                    zIndex: 20,\n                    pointerEvents: 'none'\n                  }}\n                >\n                  {tooltipVisible === 'pattern' &&\n                    'Generates a unified insight based on your recent themes, topics, and emotional loops.'}\n                  {tooltipVisible === 'therapist' &&\n                    'A handoff-style recap of emotional themes, loops, and potential focus areas for therapy.'}\n                  {tooltipVisible === 'mood' && 'Visualizes your emotional trends over time.'}\n                </div>\n              )}\n\n              {isListening && <span>üéß Listening‚Ä¶</span>}\n              {isProcessing && (\n                <div className=\"processing-message\">\n                  ‚è≥ {toneName(forcedTone)} is thinking<span className=\"dots\"></span>\n                </div>\n              )}\n            </div>\n\n            {/* Voice cluster with subtle separation and a narrower select */}\n            <div\n              className=\"cm-voice\"\n              style={{\n                display: 'flex',\n                alignItems: 'center',\n                gap: '8px 10px',\n                flexWrap: 'wrap',\n                borderLeft: '1px solid #e6e6e6',\n                paddingLeft: 12\n              }}\n            >\n              <label style={{ marginRight: '0.35rem' }}>üó£Ô∏è Voice:</label>\n              <select\n                value={forcedTone}\n                onChange={handleToneChange}\n                aria-label=\"Select voice\"\n                style={{ minWidth: 120, maxWidth: 160, padding: '6px 8px' }}\n              >\n                <option value=\"therapist\">Clara</option>\n                <option value=\"marcus\">Marcus</option>\n                <option value=\"frank\">Tony</option>\n                <option value=\"movies\">Movies</option>\n                <option value=\"verena\">Verena</option>\n              </select>\n              <div\n                className=\"cm-tone-desc\"\n                aria-live=\"polite\"\n              >\n                {toneDescription}\n              </div>\n            </div>\n          </div>\n          {/* END toolbar */}\n        </div>\n        {/* END fixed input container */}\n\n        {/* Timeline (outside the fixed container) */}\n        <div style={{ \n          flex: 1, \n          overflowY: 'auto', \n          paddingBottom: window.innerWidth <= 768 ? '0.5rem' : '2rem',\n          WebkitOverflowScrolling: 'touch', // Smooth scrolling on iOS\n          // Remove smooth scroll to prevent zoom interference\n          scrollBehavior: 'auto',\n          touchAction: 'pan-x pan-y pinch-zoom' // Allow pinch-zoom\n        }}>\n          <JournalTimeline userId={session?.user?.id} refreshTrigger={refreshTrigger} styleVariant={styleVariant} />\n        </div>\n\n        {/* Summary Viewer */}\n        {showSummary && (\n          <div style={{ marginTop: '1rem' }}>\n            <SummaryViewer history={history} onClose={() => setShowSummary(false)} />\n          </div>\n        )}\n        {/* Mood Tracker Model */}\n        {showMoodTracker && (\n          <MoodModal\n            userId={session?.user?.id}\n            onClose={handleCloseMoodTracker}\n          />\n        )}\n      </div>\n    )}\n  </>\n);\n}\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}